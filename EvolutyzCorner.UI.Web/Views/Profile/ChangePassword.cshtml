@{
    ViewBag.Title = "ChangePassword";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}
<script src="~/Scripts/jquery-1.10.2.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.10.0/jquery.validate.min.js"></script>
<link href="~/plugins/datatables/dataTables.bootstrap.css" rel="stylesheet" />
<script src="~/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="~/plugins/datatables/dataTables.bootstrap.min.js"></script>
<script src="~/Scripts/date.format.js"></script>
<script src="~/Scripts/bootstrap-datepicker.js"></script>
<script src="~/Scripts/bootstrap-datepicker.min.js"></script>
<style type="text/css">
    @@import url(https://fonts.googleapis.com/css?family=Lato:300,400,600);

    .error {
        color: red;
    }


    .nice-form {
        font-family: lato;
    }

        .nice-form * {
            box-sizing: border-box;
        }


        .nice-form label.is-replaced {
            color: #222;
            position: absolute;
            line-height: 50px;
            padding: 0 0.6em;
            left: 0;
            top: 0;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            opacity: 0.4;
            min-width: 100%;
            pointer-events: none;
            -webkit-transform-origin: top left;
            transform-origin: top left;
            transition: all 0.2s cubic-bezier(0.65, 0.05, 0.36, 1);
        }

        .nice-form input:not([type=submit]),
        .nice-form input:not([type=reset]),
        .nice-form input:not([type=button]),
        .nice-form input:not([type=radio]),
        .nice-form input:not([type=checkbox]),
        .nice-form textarea {
            display: block;
            width: 100%;
            max-width: 100%;
            height: 50px;
            border: 1px solid rgba(112, 128, 144, 0.5);
            border-radius: 3px;
            padding: 0 0.6em;
            transition: 0.2s ease, min-height 0 linear;
        }

            .nice-form input:not([type=submit]).filled,
            .nice-form input:not([type=reset]).filled,
            .nice-form input:not([type=button]).filled,
            .nice-form input:not([type=radio]).filled,
            .nice-form input:not([type=checkbox]).filled,
            .nice-form textarea.filled {
                border: 1px solid slategrey;
            }

            .nice-form input:not([type=submit]):focus,
            .nice-form input:not([type=reset]):focus,
            .nice-form input:not([type=button]):focus,
            .nice-form input:not([type=radio]):focus,
            .nice-form input:not([type=checkbox]):focus,
            .nice-form textarea:focus {
                border-color: #f6a55a;
                box-shadow: inset 0 0 2px #f6a55a;
                outline: none;
                padding-left: 15px;
            }

        .nice-form textarea {
            padding-top: 0.9em;
            min-height: 8em;
        }

        .nice-form .input-group {
            position: relative;
            overflow: hidden;
        }

            .nice-form .input-group:not(:last-child) {
                margin-bottom: 1em;
            }

            .nice-form .input-group input:not([type=submit]):focus ~ label,
            .nice-form .input-group input:not([type=reset]):focus ~ label,
            .nice-form .input-group input:not([type=button]):focus ~ label,
            .nice-form .input-group input:not([type=radio]):focus ~ label,
            .nice-form .input-group input:not([type=checkbox]):focus ~ label,
            .nice-form .input-group textarea:focus ~ label {
                -webkit-transform: scale(0.7) translateY(-0.5em) translateX(0);
                transform: scale(0.7) translateY(-0.5em) translateX(0);
                color: #ff8546;
                left: 0;
                min-width: 1%;
                opacity: 0.55;
            }

            .nice-form .input-group input:not([type=submit]).filled ~ label,
            .nice-form .input-group input:not([type=reset]).filled ~ label,
            .nice-form .input-group input:not([type=button]).filled ~ label,
            .nice-form .input-group input:not([type=radio]).filled ~ label,
            .nice-form .input-group input:not([type=checkbox]).filled ~ label,
            .nice-form .input-group textarea.filled ~ label {
                transition: all 0.3s cubic-bezier(0.65, 0.05, 0.36, 1), -webkit-transform 0.15s cubic-bezier(0.65, 0.05, 0.36, 1);
                transition: all 0.3s cubic-bezier(0.65, 0.05, 0.36, 1), transform 0.15s cubic-bezier(0.65, 0.05, 0.36, 1);
                transition: all 0.3s cubic-bezier(0.65, 0.05, 0.36, 1), transform 0.15s cubic-bezier(0.65, 0.05, 0.36, 1), -webkit-transform 0.15s cubic-bezier(0.65, 0.05, 0.36, 1);
                left: 0;
                min-width: 1%;
                -webkit-transform: scale(0.7) translateY(-0.5em) translateX(0);
                transform: scale(0.7) translateY(-0.5em) translateX(0);
                opacity: 0.5;
            }



        .nice-form button {
            background: #ffb789;
            color: #d45108;
            border: none;
            border-radius: 21px;
            padding: 10px 20px;
            font-weight: 600;
            min-width: 100%;
        }

    @@media screen and (min-width: 40em) {
        .nice-form {
            width: 40em;
            margin: auto;
        }

            .nice-form input:not([type=submit]),
            .nice-form input:not([type=reset]),
            .nice-form input:not([type=button]),
            .nice-form input:not([type=radio]),
            .nice-form input:not([type=checkbox]),
            .nice-form textarea,
            .nice-form .input-group {
                width: 20em;
                margin: auto;
            }

            .nice-form button {
                min-width: 0;
            }
    }

    .input-group span.toggle-password {
        background-color: transparent;
        border: 0;
        color: #9999a9;
        position: absolute;
        right: 10px;
        width: auto;
        height: auto;
        padding: 0;
        top: 25%;
    }

        .input-group span.toggle-password.info {
            color: #ff8546;
        }

    .nice-form .input-group input:focus ~ span.toggle-password {
        right: 10px;
    }


    .nice-form .input-group input.filled ~ span.toggle-password {
        transition: all 0.3s cubic-bezier(0.65, 0.05, 0.36, 1), -webkit-transform 0.15s cubic-bezier(0.65, 0.05, 0.36, 1);
        transition: all 0.3s cubic-bezier(0.65, 0.05, 0.36, 1), transform 0.15s cubic-bezier(0.65, 0.05, 0.36, 1);
        transition: all 0.3s cubic-bezier(0.65, 0.05, 0.36, 1), transform 0.15s cubic-bezier(0.65, 0.05, 0.36, 1), -webkit-transform 0.15s cubic-bezier(0.65, 0.05, 0.36, 1);
        -webkit-transform: translateX(0);
        transform: translateX(0);
        right: 10px;
    }

    .nice-form .input-group input.filled-medium ~ span.toggle-password {
        -webkit-transform: scale(0.8) translateY(-1.3em) translateX(0);
        transform: scale(0.8) translateY(-1.3em) translateX(0);
    }

    .nice-form .input-group input.filled-alot ~ span.toggle-password {
        -webkit-transform: scale(0.7) translateY(-1.5em) translateX(0);
        transform: scale(0.7) translateY(-1.5em) translateX(0);
        right: 10px;
    }
</style>
<style type="text/css">
    input[type=password]::-ms-reveal,
    input[type=password]::-ms-clear {
        display: none;
    }
</style>
<fieldset>
    <div class="block-content">
        <div class="">
            <h4 class="heading-fancy"> Change Password </h4>
        </div>
        <div class="nice-form">
            <form id="myform">
                <div class="input-group" data-group-name="EOP">
                    <label for="EOP">Enter Old Password</label>
                    <input type="password" name="EOP" id="EOP" onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false" autocomplete=off />
                    <span class="input-group-addon toggle-password" toggle="#EOP "><span class="fa fa-eye-slash"></span></span>
                    <label id="eoperror" class="error"></label>

                </div>
                <div class="input-group" data-group-name="ENP">
                    <label for="ENP">Enter New Password</label>
                    <input type="password" name="ENP" id="ENP" onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false" autocomplete=off />
                    <span class="input-group-addon toggle-password" toggle="#ENP "><span class="fa fa-eye-slash"></span></span>
                    <label id="enperror" class="error"></label>
                </div>
                <div class="input-group" data-group-name="RNP">
                    <label for="RNP">Re-Enter New Password</label>
                    <input type="password" name="RNP" id="RNP" onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false" autocomplete=off />
                    <span class="input-group-addon toggle-password" toggle="#RNP "><span class="fa fa-eye-slash"></span></span>
                    <label id="rnperror" class="error"></label>
                </div>
                <div class="input-group">
                    <button type="submit" id="save">Change</button>
                </div>
            </form>
        </div>
    </div>
</fieldset>



<script type="text/javascript">
    $(".toggle-password").click(function () {
        $(this).toggleClass("info");
        $(this).find('span.fa').toggleClass("fa-eye-slash fa-eye");
        var input = $($(this).attr("toggle"));
        if (input.attr("type") == "password") {
            input.attr("type", "text");
        } else {
            input.attr("type", "password");
        }
    });
</script>
<script type="text/javascript">

    $(document).ready(function () {
        $("#save").click(function () {
            $('#myform').validate({
                rules: {
                    EOP: {
                        required: true
                    },
                    ENP: {
                        required: true,
                        notEqual: "#EOP",
                        reg: /^.*(?=.{8,})(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[@@#$%&]).*$/
                    },
                    RNP: {
                        required: true,
                        reg: /^.*(?=.{8,})(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[@@#$%&]).*$/,
                        equalTo: "#ENP",
                        //notEqual: "#EOP"
                    },


                },
                submitHandler: function (form) {

                    var oldpassword = $("#EOP").val();
                    var newpassword = $("#ENP").val();

                    $.ajax({
                        type: "POST",
                        url: "/Profile/CheckPassword",
                        data: { 'oldpassword': oldpassword, 'newpassowrd': newpassword },
                        cache: false,
                        success: function (res) {
                            if (res === "Please Enter Correct Password") {
                                $("#eoperror").text("Please Enter Correct Password");
                            } else {
                                alert(res);
                                //window.location.href = "/Profile/Index";
                                window.location.href = "/Home/Login";
                            }


                        },

                        error: function (Result) {

                        }

                    });

                    return false;
                }
            });

            $.validator.addMethod("notEqual", function (value, element, param) {
                return this.optional(element) || value !== $(param).val();
            }, "New Password Must be different to Old Password");

            $.validator.addMethod("reg", function (value, element, regexpr) {
                return regexpr.test(value);
            }, "Password Must contain 1 Capital,1 small,1 number,1 Special Character and length must be 8 and above");


        });
    });
    $(function () {


        var $forms = $(".nice-form"),
            $inputs = $forms.find("textarea, input:not([type=submit],[type=reset],[type=button],[type=radio],[type=checkbox])");

        $inputs.each(function (k, el) {

            var $input = $(el),
                $label = $input.prev("label");

            if ($label.length) {

                $label.
                    insertAfter($input).
                    add($input).
                    addClass("is-replaced");

                $input.on("change focus blur compositionchange compositionend keyup", function (ev) {

                    var $tar = $(ev.target),
                        chars = $tar.val().trim().length,
                        filled = $tar.val().trim() !== "",
                        medium = chars >= 5 && chars < 15,
                        alot = chars >= 15;

                    $tar.toggleClass("filled", filled);

                    if (alot) {

                        $tar.
                            addClass("filled-alot").
                            removeClass("filled-medium");

                    } else if (medium) {

                        $tar.
                            addClass("filled-medium").
                            removeClass("filled-alot");

                    } else {

                        $tar.removeClass("filled-alot filled-medium");

                    }

                });

            }

            if ($input.val() !== "") {

                $input.trigger("change");

            }

        });



    });
</script>
