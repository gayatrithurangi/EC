
@{
    ViewBag.Title = "AccountTimeSheet";
    //  Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

@*<h2>AccountTimeSheet</h2>*@
<script src="~/Scripts/jquery-1.10.2.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.10.0/jquery.validate.min.js"></script>
<link href="~/plugins/datatables/dataTables.bootstrap.css" rel="stylesheet" />
<script src="~/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="~/plugins/datatables/dataTables.bootstrap.min.js"></script>
<script src="~/Scripts/date.format.js"></script>

<script src="~/Scripts/bootstrap-datepicker.js"></script>
<script src="~/Scripts/bootstrap-datepicker.min.js"></script>


<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.22/pdfmake.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>


<script src="~/plugins/datatables/dataTables.buttons.min.js"></script>
<script src="~/plugins/datatables/jszip.min.js"></script>
<script src="~/plugins/datatables/vfs_fonts.js"></script>
<script src="~/plugins/datatables/buttons.html5.min.js"></script>
<script src="~/plugins/datatables/buttons.colVis.min.js"></script>
@*<script src="~/EvolutyzCornerScripts/AdminPreview.js"></script>*@
<script src="~/EvolutyzCornerScripts/PreviewTimesheet.js"></script>
<script src="~/EvolutyzCornerScripts/ByMonthlyPreviewTimesheet15days.js"></script>
<script src="~/EvolutyzCornerScripts/ByMonthlyPreviewTimesheet.js"></script>
<script src="~/EvolutyzCornerScripts/WeeklyPreview.js"></script>






<style>
    #previewFlImage1,
    #previewFlImage {
        /*max-height: 200px;*/
        max-width: 100px;
    }

    .table-responsive > .table-block {
        position: relative;
    }

    .table-block > .tblform-inline {
        display: inline-block;
        /*margin-top:-30px;*/
        position: absolute;
        top: 0;
        left: 0;
        z-index: 1;
    }

    @@media (min-width:768px) {
        .table-block > .tblform-inline > .form-control {
            display: inline-block;
            width: auto;
            vertical-align: middle;
        }
    }

    .table-block > .dataTables_wrapper {
        position: relative;
        clear: both;
    }

        .table-block > .dataTables_wrapper > .dt-buttons {
            float: right;
            margin-top: 2px;
            margin-left: 5px;
        }

    label.error {
        position: absolute;
        bottom: -20px;
        left: 15px;
        font-size: 10px;
        color: red;
    }

    .form-control.validate_msg ~ span.field-validation-valid:before {
        content: "";
        position: absolute;
        bottom: -15px;
        left: 15px;
        font-size: 10px;
        color: red;
    }

    #UsT_UserTypeCode.validate_msg ~ span:before {
        content: "Employee Code Already Existed";
    }

    #UsT_UserType.validate_msg ~ span:before {
        content: "Employee Type Already Existed";
    }

    .box.box-solid.box-brown {
        border: 1px solid #aaaaaa;
    }

        .box.box-solid.box-brown > .box-header {
            /*background-color: #a3765b;
        color: #fff;*/
            border-color: #aaaaaa;
            background: #cccccc url(../Content/themes/base/images/ui-bg_highlight-soft_75_cccccc_1x100.png) 50% 50% repeat-x;
            color: #222222;
        }

        .box.box-solid.box-brown .btn-warning {
            background-color: #f97045;
            border-color: #fe450b;
        }

        .box.box-solid.box-brown .btn-success {
            background-color: #fea728;
            border-color: #FF9800;
        }

    #divhiduserid ~ label {
        margin: 7px auto;
    }
</style>

<style>
    table > tbody > tr.brown {
        background: #ffdfdd;
    }

        table > tbody > tr.brown > td {
            border-color: #ff996a;
        }

    fieldset.note-status {
        float: left;
        text-align: left;
        padding: 5px 15px 10px;
        margin: 0 2px;
        border: 1px solid silver;
    }

        fieldset.note-status > legend {
            width: auto;
            margin-bottom: auto;
            font-size: 16px;
            font-weight: 600;
            border: 0;
            padding: 0 10px;
        }

        fieldset.note-status > label {
            margin: 0 5px;
        }

            fieldset.note-status > label:before {
                content: "*";
                width: 18px;
                height: 18px;
                line-height: 22px;
                display: inline-block;
                color: #fff;
                text-align: center;
                border-radius: 50%;
                margin-right: 5px;
            }

            /*fieldset.note-status > label.black:before {
                background-color: black;
            }*/

            fieldset.note-status > label.green:before {
                background-color: green;
            }

            fieldset.note-status > label.red:before {
                background-color: red;
            }

            fieldset.note-status > label.blue:before {
                background-color: blue;
            }

            fieldset.note-status > label.deepskyblue:before {
                background-color: deepskyblue;
            }

            fieldset.note-status > label.yellow:before {
                background-color: yellow;
            }

            fieldset.note-status > label.#deaa7c:before {
                background-color: #deaa7c;
            }

    .box.box-solid.box-brown {
        border: 1px solid #aaaaaa;
    }

    .flex {
        display: flex;
        display: -webkit-flex;
        display: -ms-flexbox;
    }

    .box.box-solid.box-brown > .box-header {
        /*background-color: #a3765b;
        color: #fff;*/
        border-color: #aaaaaa;
        background: #cccccc url(../Content/themes/base/images/ui-bg_highlight-soft_75_cccccc_1x100.png) 50% 50% repeat-x;
        color: #222222;
    }

    /*.box.box-solid.box-brown .btn-warning
        {
            background-color: #f97045;
            border-color: #fe450b;
        }

        .box.box-solid.box-brown .btn-success
        {
            background-color: #fea728;
            border-color: #FF9800;
        }*/
    .block-content .btn-warning {
        background-color: #f97045;
        border-color: #fe450b;
    }

    .block-content .btn-success {
        background-color: #fea728;
        border-color: #FF9800;
    }

    #divhiduserid ~ label {
        margin: 7px auto;
    }
</style>

<style>
    a.btn-icn ~ a.btn-icn {
        margin-left: auto;
    }

    table.dataTable > tbody > tr > td:last-child > a.btn-icn:last-child {
        margin-left: 15px;
    }
    /*b[class^="ts_ManagerNames"],*/
    table#body_ClientDetails td > b ~ b {
        display: block;
    }

    table[id^="SubTable"] td.colored {
        color: #555;
        background-color: #fff;
        border: 1px solid #ccc;
    }

    table[id^="SubTable"] tr > td:first-child {
        word-spacing: 5px;
        text-align: right;
        padding-right: 15px;
    }

    @@import url(https://fonts.googleapis.com/css?family=Titillium+Web|Ubuntu:400,500);

    #ProjectNameid > b {
        color: #ff824b;
        background: linear-gradient(102deg, #fd6d29 0%, #ff9905 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .box.box-solid.box-brown {
        border: 1px solid #aaaaaa;
    }
    /*.modal-footer .btn-clr2 {
        border-color: #ff5b28;
        background: -webkit-linear-gradient(135deg,#ff9465,#ffc8ae);
        background: linear-gradient(45deg,#fb6434,#fb948d);
    }*/
    [class*="btn-custom"] {
        text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.5);
        box-shadow: inset 0px -10px 15px rgba(0, 0, 0, 0.2), 1px 1px 5px rgba(0,0,0,0.2);
        -webkit-box-shadow: inset 0px -10px 15px rgba(0, 0, 0, 0.2), 1px 1px 5px rgba(0,0,0,0.2);
    }

    .modal-footer > .btn-custom1 {
        border-color: #06960c;
        background: -webkit-linear-gradient(45deg,#4CAF50,#8BC34A);
        background: linear-gradient(45deg,#4CAF50,#8BC34A);
    }

    .modal-footer > .btn-custom2 {
        border-color: #ff5b28;
        background: -webkit-linear-gradient(135deg,#ff9465,#ffc8ae);
        background: linear-gradient(45deg,#fb6434,#fb948d);
    }

    #btnApprove.evInputBtn, #btnSend.evInputBtn {
        background: #4CAF50;
    }
    /*a.btn-icn {
        display: none
    }

    a.btn-icn-hide {
        display: inline-block
    }*/

    #btnReject.evInputBtn {
        background: #ff3f30;
    }

    #btnSave.evInputBtn {
        background: #ff9800;
    }

    .panel-default > .panel-heading {
        background-color: #ececec;
    }

    .box.box-solid.box-brown > .box-header {
        /*background-color: #a3765b;
        color: #fff;*/
        border-color: #aaaaaa;
        background: #cccccc url(../Content/themes/base/images/ui-bg_highlight-soft_75_cccccc_1x100.png) 50% 50% repeat-x;
        color: #222222;
    }

    /*.box.box-solid.box-brown .btn-warning
        {
            background-color: #f97045;
            border-color: #fe450b;
        }

        .box.box-solid.box-brown .btn-success
        {
            background-color: #fea728;
            border-color: #FF9800;
        }*/
    .block-content .btn-warning {
        background-color: #f97045;
        border-color: #fe450b;
    }

    .block-content .btn-success {
        background-color: #fea728;
        border-color: #FF9800;
    }

    #divhiduserid ~ label {
        margin: 7px auto;
    }

    .hide_column {
        display: none;
    }
</style>

<style>
    #UserGridData td > span.badge.badge-radius[id="Saved Timesheet"],
    #ManagerGridData td > span.badge.badge-radius[id="Saved Timesheet"] {
        background-color: yellow;
    }

    #UserGridData td > span.badge.badge-radius[id="Waiting for Approval at Both Managers"],
    #ManagerGridData td > span.badge.badge-radius[id="Waiting for Approval at Both Managers"] {
        background-color: deepskyblue;
    }

    #UserGridData td > span.badge.badge-radius[id="Waiting for Approval at Level_1 Manager"],
    #ManagerGridData td > span.badge.badge-radius[id="Waiting for Approval at Level_1 Manager"] {
        background-color: deepskyblue;
    }

    #UserGridData td > span.badge.badge-radius[id="Waiting for Approval at Level_2 Manager"],
    #ManagerGridData td > span.badge.badge-radius[id="Waiting for Approval at Level_2 Manager"] {
        background-color: deepskyblue;
    }

    #UserGridData td > span.badge.badge-radius[id="Waiting for Approval"],
    #ManagerGridData td > span.badge.badge-radius[id="Waiting for Approval"] {
        background-color: deepskyblue;
    }

    #UserGridData td > span.badge.badge-radius[id="Waiting for Approval at Both Managers"],
    #ManagerGridData td > span.badge.badge-radius[id="Waiting for Approval at Both Managers"] {
        background-color: deepskyblue;
    }

    #UserGridData td > span.badge.badge-radius[id="Approved by Both Managers"],
    #ManagerGridData td > span.badge.badge-radius[id="Approved by Both Managers"] {
        background-color: green;
    }

    #UserGridData td > span.badge.badge-radius[id="Approved By Level_1 Manager"],
    #ManagerGridData td > span.badge.badge-radius[id="Approved By Level_1 Manager"] {
        background-color: green;
    }


    #UserGridData td > span.badge.badge-radius[id="Approved By Level_2 Manager"],
    #ManagerGridData td > span.badge.badge-radius[id="Approved By Level_2 Manager"] {
        background-color: green;
    }


    #UserGridData td > span.badge.badge-radius[id="Approved By Level_1 Manager and Pending at Level_2 Manager"],
    #ManagerGridData td > span.badge.badge-radius[id="Approved By Level_1 Manager and Pending at Level_2 Manager"] {
        background-color: #deaa7c;
    }

    /*#UserGridData td > span.badge.badge-radius[id="Pending at Level_1 Manager and Approved by Level_2 Manager"],
    #ManagerGridData td > span.badge.badge-radius[id="Pending at Level_1 Manager and Approved by Level_2 Manager"] {
        background-color: orange;
    }*/

    #UserGridData td > span.badge.badge-radius[id="Rejected at Level_1 Manager"],
    #ManagerGridData td > span.badge.badge-radius[id="Rejected at Level_1 Manager"] {
        background-color: red;
    }

    #UserGridData td > span.badge.badge-radius[id="Rejected"],
    #ManagerGridData td > span.badge.badge-radius[id="Rejected"] {
        background-color: red;
    }

    #UserGridData td > span.badge.badge-radius[id="Rejected at Level_2 Manager"],
    #ManagerGridData td > span.badge.badge-radius[id="Rejected at Level_2 Manager"] {
        background-color: red;
    }

    #UserGridData td > span.badge.badge-radius[id="Revoked at Admin"],
    #ManagerGridData td > span.badge.badge-radius[id="Revoked at Admin"] {
        background-color: red;
    }



    .box.box-solid.box-brown > .box-header > .btn-app {
        border-radius: 50%;
        margin: auto;
        height: auto;
        line-height: 0;
        min-width: inherit;
        float: right;
        padding: 0;
        background-color: transparent;
        border: 0;
    }

        .box.box-solid.box-brown > .box-header > .btn-app > .fa {
            font-size: 24px;
        }

    span.badge.badge-radius {
        float: none;
        position: relative;
        background-color: #555;
        color: #fff;
        width: 15px;
        height: 15px;
        border-radius: 50%;
        display: inline-block;
    }
    /*span.badge.badge-radius[title]:hover:after {
            content: attr(title);
            padding: 4px 8px;
            color: #333;
            position: absolute;
            left: 0;
            top: 100%;
            white-space: nowrap;
            z-index: 20;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            border-radius: 5px;
            -moz-box-shadow: 0px 0px 4px #222;
            -webkit-box-shadow: 0px 0px 4px #222;
            box-shadow: 0px 0px 4px #222;
            background-image: -moz-linear-gradient(top, #eeeeee, #cccccc);
            background-image: -webkit-gradient(linear,left top,left bottom,color-stop(0, #eeeeee),color-stop(1, #cccccc));
            background-image: -webkit-linear-gradient(top, #eeeeee, #cccccc);
            background-image: -moz-linear-gradient(top, #eeeeee, #cccccc);
            background-image: -ms-linear-gradient(top, #eeeeee, #cccccc);
            background-image: -o-linear-gradient(top, #eeeeee, #cccccc);
        }*/
    .evInputBtn {
        display: inline-block;
        padding: 5px 10px;
        margin: 3px 5px;
        background: #848484;
        color: #FFF !important;
        font-size: 14px;
        font-weight: bold;
        text-decoration: none;
        text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.5);
        border: none;
        -webkit-border-radius: 5px;
        -moz-border-radius: 5px;
        border-radius: 5px;
        box-shadow: inset 0px -10px 15px rgba(0, 0, 0, 0.2), 1px 1px 5px rgba(0,0,0,0.2);
        -webkit-box-shadow: inset 0px -10px 15px rgba(0, 0, 0, 0.2), 1px 1px 5px rgba(0,0,0,0.2);
        -moz-box-shadow: inset 0px -10px 15px rgba(0, 0, 0, 0.2), 1px 1px 5px rgba(0,0,0,0.2);
        cursor: pointer;
    }

    /*.evInputBtn:hover {
            background: #FF6600;
        }*/

    #Cmtsave {
        padding: 0 10px;
    }

    .contentArea {
        background: #FFF url(../images/shadow.png) repeat-x;
        box-shadow: 0px 5px 8px rgba(183, 35, 35, 0.81);
        padding: 30px;
        min-height: 350px;
    }

    #MainTable {
        border: 0px !important;
    }

    #SubTable {
        border: 0px !important;
    }

    #SubTable2 {
        border: 0px !important;
    }


    table#ClientDetails,
    table#body_ClientDetails {
        margin: 10px auto;
        width: 100%;
        border: 1px solid rgba(0, 0, 0, 0.25);
        border-collapse: separate;
        border-radius: 30px;
        -webkit-border-radius: 30px;
        -moz-border-radius: 30px;
        box-shadow: 0px 2px 4px 1px rgba(0, 0, 0, 0.2);
        -webkit-box-shadow: 0px 2px 4px 1px rgba(0, 0, 0, 0.2);
        -moz-box-shadow: 0px 2px 4px 1px rgba(0, 0, 0, 0.2);
    }

        table#ClientDetails td,
        table#body_ClientDetails td {
            border: none;
            /*width: auto;*/
        }

        table#ClientDetails tr > td:nth-child(even),
        table#body_ClientDetails tr > td:nth-child(even) {
            border-right: 1px solid rgba(0, 0, 0, 0.19);
        }

        table#ClientDetails tr > td:last-child,
        table#body_ClientDetails tr > td:last-child {
            border-right: none;
        }

    tbody > tr:only-child:nth-child(odd) {
        background: none;
    }

    .evAdminTable th {
        border-bottom: 0px solid #EAEAEA;
        padding: 5px;
        background: #666;
        color: #FFF;
    }

    table td, table th {
        padding: 3px 6px;
    }

    table tr:nth-of-type(odd) {
        background: #f9f9f9;
    }

    table > tbody > tr.brown {
        background: #ffdfdd;
    }

        table > tbody > tr.brown > td {
            border-color: #ff996a;
        }

    table #MainTable > td[id^="td"] {
        border: 0;
        width: 50%;
        vertical-align: top;
    }

    table td > .form-control {
        border-radius: 0px;
        height: auto;
        padding: 2px;
    }

    table td > select.form-control {
        width: 100%;
    }

    table #MainTable > td[id^="td"]:first-child {
        padding-left: 0;
    }

    table#MainTable > td[id^="td"]:last-child {
        padding-right: 0;
    }

    table [id^="SubTable"] tr > td:last-child {
        display: none;
    }

    .box .panel-heading > h3.panel-title {
        font-weight: 600;
        font-family: 'Titillium Web', sans-serif;
    }
</style>

<style>
    #loading-image {
        position: fixed;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        z-index: 1035;
        background-color: rgba(243, 243, 243, 0.75);
        /*opacity: .8;*/
    }

        #loading-image > img {
            /*width: 56px;
            height: 56px;
            border: 8px solid rgba(255, 87, 34, 0.25);
            border-top-color: #f37a41;
            border-radius: 50%;*/
            position: absolute;
            /* animation: loader-rotate 1s linear infinite; */
            top: 50%;
            left: 50%;
            margin: -60px auto 0;
            max-width: 100%;
            display: block;
            height: 100px;
        }

        #loading-image > span {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            position: absolute;
            animation: loader-circles 1s linear infinite;
            top: 50%;
            left: 50%;
            margin: -20px auto 0;
        }

        #loading-image > strong {
            position: absolute;
            top: 50%;
            left: 48%;
            margin: 0px auto 0;
            font-size: 10px;
        }

    @@keyframes loader-circles {
        0% {
            box-shadow: 0 -85px 0 0 rgba(255, 87, 34, 0.05), 61px -61px 0 0 rgba(255, 87, 34, 0.1), 85px 0 0 0 rgba(255, 87, 34, 0.2), 61px 61px 0 0 rgba(255, 87, 34, 0.3), 0 85px 0 0 rgba(255, 87, 34, 0.4), -61px 61px 0 0 rgba(255, 87, 34, 0.6), -85px 0 0 0 rgba(255, 87, 34, 0.8), -61px -61px 0 0 #f37a41;
        }

        12.5% {
            box-shadow: 0 -85px 0 0 #f37a41, 61px -61px 0 0 rgba(255, 87, 34, 0.05), 85px 0 0 0 rgba(255, 87, 34, 0.1), 61px 61px 0 0 rgba(255, 87, 34, 0.2), 0 85px 0 0 rgba(255, 87, 34, 0.3), -61px 61px 0 0 rgba(255, 87, 34, 0.4), -85px 0 0 0 rgba(255, 87, 34, 0.6), -61px -61px 0 0 rgba(255, 87, 34, 0.8);
        }

        25% {
            box-shadow: 0 -85px 0 0 rgba(255, 87, 34, 0.8), 61px -61px 0 0 #f37a41, 85px 0 0 0 rgba(255, 87, 34, 0.05), 61px 61px 0 0 rgba(255, 87, 34, 0.1), 0 85px 0 0 rgba(255, 87, 34, 0.2), -61px 61px 0 0 rgba(255, 87, 34, 0.3), -85px 0 0 0 rgba(255, 87, 34, 0.4), -61px -61px 0 0 rgba(255, 87, 34, 0.6);
        }

        37.5% {
            box-shadow: 0 -85px 0 0 rgba(255, 87, 34, 0.6), 61px -61px 0 0 rgba(255, 87, 34, 0.8), 85px 0 0 0 #f37a41, 61px 61px 0 0 rgba(255, 87, 34, 0.05), 0 85px 0 0 rgba(255, 87, 34, 0.1), -61px 61px 0 0 rgba(255, 87, 34, 0.2), -85px 0 0 0 rgba(255, 87, 34, 0.3), -61px -61px 0 0 rgba(255, 87, 34, 0.4);
        }

        50% {
            box-shadow: 0 -85px 0 0 rgba(255, 87, 34, 0.4), 61px -61px 0 0 rgba(255, 87, 34, 0.6), 85px 0 0 0 rgba(255, 87, 34, 0.8), 61px 61px 0 0 #f37a41, 0 85px 0 0 rgba(255, 87, 34, 0.05), -61px 61px 0 0 rgba(255, 87, 34, 0.1), -85px 0 0 0 rgba(255, 87, 34, 0.2), -61px -61px 0 0 rgba(255, 87, 34, 0.3);
        }

        62.5% {
            box-shadow: 0 -85px 0 0 rgba(255, 87, 34, 0.3), 61px -61px 0 0 rgba(255, 87, 34, 0.4), 85px 0 0 0 rgba(255, 87, 34, 0.6), 61px 61px 0 0 rgba(255, 87, 34, 0.8), 0 85px 0 0 #f37a41, -61px 61px 0 0 rgba(255, 87, 34, 0.05), -85px 0 0 0 rgba(255, 87, 34, 0.1), -61px -61px 0 0 rgba(255, 87, 34, 0.2);
        }

        75% {
            box-shadow: 0 -85px 0 0 rgba(255, 87, 34, 0.2), 61px -61px 0 0 rgba(255, 87, 34, 0.3), 85px 0 0 0 rgba(255, 87, 34, 0.4), 61px 61px 0 0 rgba(255, 87, 34, 0.6), 0 85px 0 0 rgba(255, 87, 34, 0.8), -61px 61px 0 0 #f37a41, -85px 0 0 0 rgba(255, 87, 34, 0.05), -61px -61px 0 0 rgba(255, 87, 34, 0.1);
        }

        87.5% {
            box-shadow: 0 -85px 0 0 rgba(255, 87, 34, 0.1), 61px -61px 0 0 rgba(255, 87, 34, 0.2), 85px 0 0 0 rgba(255, 87, 34, 0.3), 61px 61px 0 0 rgba(255, 87, 34, 0.4), 0 85px 0 0 rgba(255, 87, 34, 0.6), -61px 61px 0 0 rgba(255, 87, 34, 0.8), -85px 0 0 0 #f37a41, -61px -61px 0 0 rgba(255, 87, 34, 0.05);
        }

        100% {
            box-shadow: 0 -85px 0 0 rgba(255, 87, 34, 0.05), 61px -61px 0 0 rgba(255, 87, 34, 0.1), 85px 0 0 0 rgba(255, 87, 34, 0.2), 61px 61px 0 0 rgba(255, 87, 34, 0.3), 0 85px 0 0 rgba(255, 87, 34, 0.4), -61px 61px 0 0 rgba(255, 87, 34, 0.6), -85px 0 0 0 rgba(255, 87, 34, 0.8), -61px -61px 0 0 #f37a41;
        }
    }
</style>

<style>
    #divEditTimesheetData.pdfHide.box.box-solid.box-brown {
        border: 0;
    }

        #divEditTimesheetData.pdfHide.box.box-solid.box-brown > .box-header {
            display: none;
        }

    #divEditTimesheetData.pdfHide #btnSave,
    #divEditTimesheetData.pdfHide fieldset.note-status,
    #divEditTimesheetData.pdfHide #btnSave ~ [type='submit'].evInputBtn {
        display: none !important;
    }

    @@media print {
        .sidebar-mini .content-wrapper {
            margin: 15px 15px 15px 45px !important;
        }
    }

    @@media screen {
        .sidebar-mini .content-wrapper {
            margin: 15px 15px 15px 45px !important;
        }
    }

    .evInputBtn.btn-warning,
    .evInputBtn.btn-warning:focus,
    .evInputBtn.btn-warning:active {
        background-color: #03a9f4;
        border-color: #00bcd4;
    }

    .evInputBtn.btn-danger,
    .evInputBtn.btn-danger:focus,
    .evInputBtn.btn-danger:active {
        background-color: #dd4b39;
        border-color: #d73925;
    }

    #body_ClientDetails {
        margin: 10px auto;
        width: 99%;
        border: 1px solid #aaaaaa;
    }

        #body_ClientDetails td {
            border: 0;
            /*width: auto;*/
            /*font-weight: 600;
            font-size: 13px;*/
        }

    a.kin {
        display: inline-block;
    }

    input[type=file]#flImage {
        display: inline-block;
    }

    img#previewFlImage {
        display: inline-block;
        max-height: 100px;
        max-width: 100px;
    }
    /*#body_ClientDetails td > b {
            font-weight: bolder;
            font-size: 14px;
        }*/
</style>

<style>
    table#body_ClientDetails > tbody > tr > td {
        padding-top: 10px;
        padding-bottom: 10px
    }

        table#body_ClientDetails > tbody > tr > td > b + b,
        table#body_ClientDetails > tbody > tr > td > div + div {
            margin-top: 10px;
        }

        table#body_ClientDetails > tbody > tr > td:first-child {
            padding-left: 20px;
        }

        table#body_ClientDetails > tbody > tr > td:last-child {
            padding-right: 20px;
        }
    table#table.dataTable > tfoot {
        position: absolute;
        top: 0px;
        left: 0px;
        z-index: 1;
        left: 40%;
        margin-left: -20px;
    }

        table#table.dataTable > tfoot > tr {
            background: transparent;
        }

            table#table.dataTable > tfoot > tr > th:empty {
                padding: 0;
            }

            table#table.dataTable > tfoot > tr > th:not(:empty) {
                background: none;
                border: none;
                padding-left: 45px;
            }

    .form-control.form-control-lg {
        width: 100%
    }
</style>

<input type="hidden" id="accid" value="@TempData["AccountId"]" />
@{
    TempData.Keep("AccountId");
}
<input type="hidden" id="PrjId" value="@TempData["ProjectId"]" />
@{
    TempData.Keep("ProjectId");
}



<div id="PdfPrint">
    <div class="block-content" id="divPreviewTimesheet" style="display:none;">

        <div class="">
            <h4 class="heading-fancy"> Timesheets Management </h4>
            <a class="btn" href="@Url.Action("Usertimesheet","Timesheet")" title="Add" id="addbtn"><i class="fa fa-plus" style="font-size: 22px;"></i> </a>
        </div>

        <div class="box-body no-padding" id="body">

            <div class="panel panel-default" id="UserGridPanel">
                <div class="panel-heading">
                    <h3 class="panel-title">My Timesheets</h3>
                </div>

                <div class="panel-body">

                    <table id="UserGridData">
                        <thead id="tblheadid">
                            <tr>
                                <th>Userid</th>
                                <th>TimesheetID</th>
                                <th>ProjectId</th>
                                <th>Project Name</th>
                                <th>ClientprojectId</th>
                                <th>Client Name</th>
                                <th>Emp Name</th>
                                <th>Month</th>
                                <th>Actual Hours</th>
                                <th>Worked Hours </th>
                                <th>Status</th>
                                <th id="actions1">Actions</th>



                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th>Project</th>
                                <th></th>
                                <th>Client</th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                        </tfoot>
                    </table>

                </div>
            </div>
            <div class="panel panel-default" id="ManagerGridPanel">
                <div class="panel-heading">
                    <h3 class="panel-title">Employee Timesheets</h3>
                </div>

                <div class="panel-body">
                    <table id="ManagerGridData" style="display:none">
                        <thead id="tblheadid">
                            <tr>
                                <th>Userid</th>
                                <th>TimesheetID</th>
                                <th>ProjectId</th>
                                <th>Project</th>
                                <th>ClientprojectId</th>
                                <th>Client Name</th>
                                <th>Employee</th>
                                <th>Timesheet Duration</th>
                                <th>TSMode</th>
                                <th>Actual Hours</th>
                                <th>Worked Hours </th>
                                <th>Status</th>
                                <th id="actions2">Actions</th>

                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th>Project</th>
                                <th></th>
                                <th>Client</th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
            <fieldset class="note-status">
                <legend>Note :</legend>
                @*<label class="black">Saturday / Sunday</label>*@
                <label class="green">Approved</label>
                <label class="red">Rejected or Revoked</label>
                <label class="deepskyblue">Waiting for Approval</label>
                <label class="yellow">Saved</label>
                @*<label class="#deaa7c">Waiting for Approval</label>*@
            </fieldset>

            @*</form>*@
        </div>

        <div class="control-sidebar-bg"></div>
    </div>
</div>


<div class="block-content">

    <div class="table-responsive">
        <div class="clearfix table-block">
            <div class="tblform-inline">
                <span>From Date:</span>
                <input type="text" class="form-control" id="min" />
                <span>To Date:</span>
                <input type="text" class="form-control" id="max" />
            </div>
            @*<div class="panel panel-default" id="tableGridPanel">
            <div class="panel-heading">
                <h3 class="panel-title">Users Submitted Timesheets</h3>
            </div>
            <div class="panel-body">

            </div>
        </div>*@
            <table id="table" style="width: 100% !important">
                <thead>
                    <tr>
                        <th>MonthlyDates</th>
                        <th>Userid</th>
                        <th>TimesheetID</th>
                        <th>ProjectId</th>
                        <th>ClientprojectId</th>
                        <th>Client</th>
                        <th>Project</th>

                        <th>Resource</th>
                        <th>Timesheet Duration</th>
                        <th>TSMode</th>
                        <th>Actual Hours</th>
                        <th>Worked Hours </th>

                        <th>Status</th>
                        <th id="actions2">Actions</th>

                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th>Client</th>
                        <th>Project</th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                    </tr>
                </tfoot>
            </table>
            <div class="panel panel-default" id="UserstableGridPanel" style="display:none">
                <div class="panel-heading">
                    <h3 class="panel-title">Users Saved Timesheets</h3>
                </div>
                <div class="panel-body">
                    <table id="UserGridData">
                        <thead id="tblheadid">
                            <tr>
                                <th>Userid</th>
                                <th>TimesheetID</th>
                                <th>ProjectId</th>
                                <th>ClientprojectId</th>
                                <th>TimesheetMode</th>
                                <th>Client</th>
                                <th>Project</th>
                                <th>Resource</th>
                                <th>Month</th>
                                <th>Actual Hours</th>
                                <th>Worked Hours </th>
                                <th>Status</th>
                                <th id="actions1">Actions</th>

                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th>Client</th>
                                <th>Project</th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>



            <div class="panel panel-default" id="UserstableGridPanel" style="display:none">
                <div class="panel-heading">
                    <h3 class="panel-title">Users Saved Timesheets</h3>
                </div>
                <div class="panel-body">
                    <table id="UserGridData">
                        <thead id="tblheadid">
                            <tr>
                                <th>Userid</th>
                                <th>TimesheetID</th>
                                <th>ProjectId</th>
                                <th>ClientprojectId</th>
                                <th>TimesheetMode</th>
                                <th>Client</th>
                                <th>Project</th>
                                <th>Resource</th>
                                <th>Month</th>
                                <th>Actual Hours</th>
                                <th>Worked Hours </th>
                                <th>Status</th>
                                <th id="actions1">Actions</th>

                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th>Client</th>
                                <th>Project</th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>
<!-------EditTaskDetails <!-- Horizontal Form divEditTimesheetData-->
<div class="box box-solid box-brown" id="divEditTimesheetData">
    <div class="box-header with-border">
        <h3 class="box-title">Preview Timesheet</h3>
        <a class="btn btn-app" href="Usertimesheet" title="Add"><i class="fa fa-plus-circle" style=" color: #FF9800; text-shadow: 0px 0px 2px #7d7d7d; "></i> </a>
    </div>

    <div class="box-body" id="body">

        <div class="clearfix">
            <div class="text-center" id="clientLogo">
                @*<img src="~/uploadimages/images/@ViewBag.imageid" style="margin:auto; height:100px;" class="img-responsive" />*@
                <img src="~/uploadimages/images/thumb/@ViewBag.imageid" style="margin:auto; height:100px;" class="img-responsive showimage" />

            </div>

            <div id="StardateToEnddate" style="color:coral;font-size:large;text-align:center"></div>
            <div id="UserStatus" style="color:coral;font-size:large;text-align:center"></div>

        </div>
        <table cellspacing="0" cellpadding="0" border="0" id="body_ClientDetails">
            <tbody>
                <tr>
                    <td align="right" width="110" class="alt">
                        <b>Client Name:</b>
                        <b>Project Name:</b>

                    </td>
                    <td>

                        <div id="ts_ClientNameid">  </div>
                        <div id="ts_ProjectNameid"></div>

                    </td>
                    <td align="right" width="90" class="alt">
                        <b>Manager 1:</b>
                        @*<b id="ts_Manager2">Manager 2:</b>*@
                        <b>Manager 2:</b>


                        @*<b id="ts_submited">Submitted on:</b>*@
                    </td>
                    <td>
                        <div id="ts_ManagerNamesid1"></div>
                        <div id="ts_ManagerNamesid2"></div>

                        @*<div id="ts_Submittedid"></div>*@
                    </td>
                    <td width="110" align="right" class="alt">

                        <b>Duration :</b>
                        @*<b id="ts_approid">Approved on:</b>*@
                        <b>Approved on:</b>

                    </td>
                    <td width="200">
                        <div id="Timesheet_Duration"></div>
                        <div id="ts_Approveid"></div>
                    </td>
                   
                    <td width="130" align="right" class="alt">
                   
                        <b>Timesheet Mode :</b>
                        @*<b>Status :</b>*@

                    </td>
                    <td width="100">
                        <div id="Timesheet_dvTSMode"></div>
                        @*<div id="TimesheetApprovalStatus"></div>*@
                        @*<div id="full.TimesheetApprovalStatus"></div>*@



                    </td>
                   
                </tr>
            </tbody>
        </table>
        <div id="tabCon"></div>
        <div id="TotHrs" style="float:right;position:relative;right:19px;font-size:large;display:block"><label>Total Working Hours:</label>&nbsp;&nbsp;<label name="totCount" id="TotalHoursCount"></label></div>
    </div>

    <div id="ShareButton" class="modal" role="dialog">
        <div class="modal-dialog">

            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Share Timesheet</h4>
                </div>
                <div class="modal-body" id="">
                    <form id="AddModal">
                        <div class="form-group row">
                            <div class="col-md-8">
                                <label>EmailId:</label>
                                <input type="email" class="form-control" name="emailto" placeholder="Email to" id="emailto" />
                            </div>
                            <div class="col-md-8">
                                <label>EmailId2:</label>
                                <input type="email" class="form-control" name="emailto2" placeholder="Email to" id="emailto2" />
                            </div>
                            <div class="col-md-8">
                                <label>subject:</label>
                                <input type="text" class="form-control" name="subject" placeholder="subject" id="subject" />
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer" id="">
                    <button type="button" class="btn btn-clr" onclick="ShareTimesheet()">Share</button>
                    <button type="button" class="btn btn-clr1" data-dismiss="modal" id="cancel_TS"> Cancel</button>
                </div>
            </div>

        </div>
    </div>

    <div id="footer">
        <div id='Cmtsave' style="display:none">
            <label style='color:coral'>Additional Comments</label>
            <div>
                <textarea name='tnameDescription' rows='2' cols='20' id='txtDescription' style='width:100%;'></textarea>

            </div>
            <div class='clearfix' style='padding: 10px;text-align:right;'>
                <fieldset class="note-status">
                    <legend>Note :</legend>
                    @*<label class="black">Saturday / Sunday</label>*@
                    <label class="green">Work from Home</label>
                    <label class="red">Leaves</label>
                    <label class="blue">Holidays</label>
                </fieldset>
                <input type='submit' name='btnSave' value='Save&amp;Close' id='btnSave' onclick=ConfirmSendTimesheet('1') class='evInputBtn'>
                &nbsp;&nbsp;
                <input type='submit' name='btnSend' value='Save&amp;Submit Timesheet' id='btnSend' onclick=ConfirmSendTimesheet('2') class='evInputBtn'>
                &nbsp;&nbsp;
                <input type='submit' name='Approve' value='ApproveTimesheet' id='btnApprove' onclick=ManagerApprOrRejFromWeb('3') style="display:none" class='evInputBtn'>
                &nbsp;&nbsp;
                <input type='submit' name='Reject' value='RejectTimesheet' id='btnReject' onclick=ManagerApprOrRejFromWeb('4') style="display:none" class='evInputBtn'>
                &nbsp;&nbsp;
                <input type='submit' id='btnclose' name='bntClose' value='Close' class='evInputBtn' title="Close" data-target="#warningmsg" data-toggle="modal">
                @*<input type='submit' id='btnPrint' name='bntPrint' value='Print' class='evInputBtn' onClick='print_page()'>
                    <input type='submit' name='btnpdf' value='Pdf' id='btnpdf' class='evInputBtn'>*@

                <button type='submit' id='btnPrint' name='bntPrint' title="Click here to print" class='evInputBtn btn-warning' onClick='print_page()' style="display:none;"><i class="fa fa-print"></i></button>
                <button type='submit' name='btnpdf' id='btnpdf' title="Click here to pdf" class='evInputBtn btn-danger' style="display:none;"><i class="fa fa-file-pdf-o"></i></button>
                <button type='submit' name='btnShare' id='btnShare' title="Click here to Share" data-target="#ShareButton" data-toggle="modal" class='evInputBtn btn-danger' style="display:none;"><i class="fa fa-share"></i></button>
            </div>
        </div>

        <input type="hidden" id="empname">
        @*<input type="file" id="flImage" name="ImageUpload" style="display:none">*@
        <label class="" id="imagelbl" style="display:none">
            <i class="fa fa-image"></i> Upload Image1<input type="file" style="display: none;" id="flImage" name="ImageUpload">
        </label>

        <a class='kin' href='javascript:;' id="images">
            <img id="previewFlImage" class="showimage" data-toggle='modal' data-target='#imgModal' />
        </a>

        <label class="" id="imagelbl1" style="display:none">
            <i class="fa fa-image"></i> Upload Image2<input type="file" style="display: none;" id="flImage1" name="ImageUpload">
        </label>

        <a class='kin' href='javascript:;' id="imagestwo">
            <img id="previewFlImage1" class="showimage" data-toggle='modal' data-target='#imgModal' />
        </a>


        @*<a class='kin' href='javascript:;' id="images">

            </a>*@

    </div>


</div>


<aside class="control-sidebar control-sidebar-dark">

    <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
        <li><a href="#control-sidebar-home-tab" data-toggle="tab"><i class="fa fa-home"></i></a></li>
        <li><a href="#control-sidebar-settings-tab" data-toggle="tab"><i class="fa fa-gears"></i></a></li>
    </ul>

</aside>
<div class="control-sidebar-bg"></div>



<div class="modal fade-in" id="ContainerGridDetail" role="dialog">

    <div class="modal-dialog modal-custom">
        @*<label id="succ"></label>*@
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" onclick="LoadAllTimesheets()" data-dismiss="modal">&times;</button>
                <h4 class="modal-title" id="PopupAppRejId"></h4>
            </div>

            <div class="modal-body">
                <p id="ProjectNameid" style="margin-bottom:auto;"></p>
            </div>
            <div class="modal-footer" style="text-align:left;">
                <input type="submit" id="btnAdd" class="btn btn-custom1" style="display:none" value="Approve" onclick=ApprovalRejectTimesheet('3')>
                <input type="submit" id="btnRej" class="btn btn-custom2" style="display:none" value="Reject" onclick=ApprovalRejectTimesheet('4')>
                <button type="button" id="btncancel" class="btn btn-clr1" onclick="LoadAllTimesheets()">Cancel</button>
                @*<button type="button" class="btn btn-clr1" data-dismiss="modal" id="close" onclick="LoadAllTimesheets()">Close</button>*@
            </div>

        </div>
    </div>

</div>

<div id="imgModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <img id="showimage" class="showimage img-responsive" style="margin:auto;height:25em" src="" />
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade-in" id="ContainerGridDetail" role="dialog">

    <div class="modal-dialog modal-custom">
        @*<label id="succ"></label>*@
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" onclick="LoadAllTimesheets()" data-dismiss="modal">&times;</button>
                <h4 class="modal-title" id="PopupAppRejId"></h4>
            </div>

            <div class="modal-body">
                <p id="ProjectNameid" style="margin-bottom:auto;"></p>
            </div>
            <div class="modal-footer" style="text-align:left;">

                @*<input type="submit" id="btnRej" class="btn btn-custom2" style="display:none" value="Revoke" onclick=RevokeTimesheet('5')>*@
                <input type="submit" id="btnRev" class="btn btn-custom2" style="display:none" value="Revoke" onclick=ApprovalRejectTimesheet('5')>

                <button type="button" id="btncancel" class="btn btn-clr1" onclick="LoadAllTimesheets()">Cancel</button>
                @*<button type="button" class="btn btn-clr1" data-dismiss="modal" id="close" onclick="LoadAllTimesheets()">Close</button>*@
            </div>

        </div>
    </div>
</div>

<script type="text/javascript">
    var Userid; var Projectname; var ClientName; var accountid, Projectid, Taskid, clientprojectid ,RoleCode;
    Userid = '@ViewBag.User_ID';
    Projectname ='@ViewBag.ProjectName';
    ClientName ='@ViewBag.ClientProjectName';
    accountid = '@ViewBag.accountid'; Projectid = '@ViewBag.Projectid';
    Taskid= '@ViewBag.tsktaskID';
    clientprojectid = '@ViewBag.ClientprojectId';
    RoleCode = $("#PFname").next("p").html();

    var TimesheetID = '', fulldate = '';
    var resultDataArray; var objUserSessionId = '';
    var resultHoursWorkedColour; var ApporRejprojectid; var SessionUsrid;
    var empname = '', empworkedhrs = '', empprojectname = '', empactualhrs = '', attchemntid;
    var uploadedImage = ""; var resultDataArrayUploadimages; var colourcode = '';
    var TimesheetPeriod = ""; var TimesheetPeriodname = "";

    function ApprovalRejectTimesheet(id) {
        

        if (id == '3' || id == '4' || id == '5') {

            if (id == '5') {
                //$("#btnRev").show();
                $("#btnRej").hide();
                $("#btnAdd").hide();
                $('#PopupAppRejId').html("Revoke Timesheet");
                $("#ProjectNameid").html("Do you want to Revoke <b> " + empname + "'s </b>timesheets within <b>" + empworkedhrs + "</b> hours for duration <b>" + TimesheetPeriod.replace('-', ' to ') + "</b> ");

            }

            id = id;
            Commentss = $.trim($("#txtDescription").val());
            MonthTimesheet = TimesheetMonth;

        }
        else {
            TimesheetID = id.getAttribute("data-TimesheetID");
            MonthTimesheet = id.getAttribute("data-MonthYear");
            tsuserid = id.getAttribute("data-Usr_UserID");
            Commentss = $.trim($("#txtDescription").val());
            var ApproveRejectstatus = id.getAttribute("data-Status");
            id = ApproveRejectstatus;

        }

        var projectid = ApporRejprojectid;
        var actualhrs = empactualhrs;

        var timesheets =

        {
            TimesheetID: TimesheetID,
            SubmittedType: id,
            TimeSheetMonth: MonthTimesheet,
            Comments: Commentss,
            UserID: tsuserid,
            ProjectID: projectid,

        }
        var sheetObj = {
            timesheets: timesheets,
        };




        $('#loading-image').attr("style", "display: block;");
        $.ajax({
            type: "POST",
            url: "/Timesheet/TimeSheetManagerActionWeb",
            data: JSON.stringify(sheetObj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                //   sendmailsbyapp(sheetObj);
                alert(data);
                window.location.reload();
            },
            complete: function () {
                $('#loading-image').attr("style", "display: none;");
            }
        });

    }


    $(document).ready(function () {

        SessionUsrid = Userid;

        $("#tabCon").empty();
        $("#timesheet_management").addClass("active");
        $("#timesheet_management").siblings().removeClass("active");
        $("#body_ClientDetails").attr("style", "display: none;");
        $("#divEditTimesheetData").attr("style", "display: none;");
        $('#loading-image').attr("style", "display: block;");
        loaddata();
    });


    function LoadAllTimesheets() {
        window.location = '/Timesheet/AccountTimeSheet';

    }

    function loaddata() {
        
        $.ajax({
            url: "/TimeSheet/GetAccTimeSheet",
            type: "Get",
            dataType: "json",
            success: function (res) {

                $.fn.dataTable.ext.search.push(
                    function (settings, data, dataIndex) {
                        
                        var min = $('#min').datepicker("getDate");
                        var max = $('#max').datepicker("getDate");
                        var date1 = data[0].split("-");
                        var startDate = new Date(date1[0]);
                        if (min == null && max == null) { return true; }
                        if (min == null && startDate <= max) { return true; }
                        if (max == null && startDate >= min) { return true; }
                        if (startDate <= max && startDate >= min) { return true; }
                        return false;
                    }
                );

                
                var table =   $('#table').DataTable({
                    'data': res,
                    'paginate': true,
                    'sort': true,
                    'Processing': true,
                    'columns': [
                        { 'data': 'ByMonthlyDates', 'visible': false, },
                        { 'data': 'Usr_UserID', 'visible': false, },
                        { 'data': 'TimesheetID', 'visible': false, },
                        { 'data': 'ProjectId', 'visible': false, },
                        { 'data': 'ClientprojectId', 'visible': false, },
                        { 'data': 'ProjectName', 'visible': true, },
                        { 'data': 'ClientProjectName', 'visible': true, },


                        { 'data': 'userName'  },
                        { 'data': 'TimesheetDuration' },
                        { 'data': 'TimesheetType' },
                        { 'data': 'CompanyBillingHours' },
                        { 'data': 'ResourceWorkingHours' },

                        {

                            "data": "ManagerApprovalStatus",

                        },
                        {

                            "render": function (TimesheetID, type, full, meta) {

                                console.log(full.ClientprojectId);

                                if ((full.TimesheetApprovalStatus == "Approved By Level_1 Manager") ||
                                    (full.TimesheetApprovalStatus == "Approved By Level_2 Manager") ||
                                    (full.TimesheetApprovalStatus == "Approved By Level_1 Manager and Pending at Level_2 Manager") ||
                                    (full.TimesheetApprovalStatus == "Approved by Both Managers"))
                                {

                                    if (full.TimesheetType == "Bi-Weekly") {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName +
                                                '"  data-userName="' + full.userName +
                                                '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                '"  data-MonthYear="' + full.Month_Year +
                                                '"  data-TimesheetMonth="' + full.TimeSheetMonth +
                                                '" data-TimesheetID="' + full.TimesheetID +
                                                '"  data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '"  data-ProjectId="' + full.ProjectId +
                                                '" data-ByMonthlyDates="' + full.ByMonthlyDates +
                                                '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId +
                                                '"data-ClientprojectId="' + full.ClientprojectId +
                                                '" title="Preview" onclick="ByWeeklyPreviewManagerSubmitTimesheet(this,' + full.ProjectId + ')" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"   data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" title="Preview" onclick="ApprovalRejectTimesheetByWeekly(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"  data-TimesheetMonth="' + full.TimeSheetMonth + '" data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ApprovalRejectTimesheetByWeekly(this)" > </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName +
                                                '"  data-userName="' + full.userName +
                                                '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                '"  data-MonthYear="' + full.Month_Year +
                                                '"  data-TimesheetMonth="' + full.TimeSheetMonth +
                                                '" data-TimesheetID="' + full.TimesheetID +
                                                '"  data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '"  data-ProjectId="' + full.ProjectId +
                                                '" data-ByMonthlyDates="' + full.ByMonthlyDates +
                                                '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId +
                                                '"data-ClientprojectId="' + full.ClientprojectId +
                                                '" title="Preview" onclick="ByWeeklyPreviewManagerSubmitTimesheet(this,' + full.ProjectId + ')" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"   data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" title="Preview" onclick="ApprovalRejectTimesheetByWeekly(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"  data-TimesheetMonth="' + full.TimeSheetMonth + '" data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ApprovalRejectTimesheetByWeekly(this)" > </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName + '" data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimesheetMonth + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-AdminEmailid="' + full.AdminEmailid + '"  data-AdminName="' + full.AdminName + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }

                                        }

                                    if (full.TimesheetType == "Weekly") {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName +
                                                '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year +
                                                '"  data-TimesheetMonth="' + full.TimeSheetMonth + '" data-TimesheetID="' + full.TimesheetID +
                                                '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '"  data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates +
                                                '"  data-TimesheetType="' + full.TimesheetType + '"  data-UProj_L1ManagerId="' + full.UProj_L1ManagerId +
                                                '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="WeeklyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"   data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="ApprovalRejectTimesheetWeekly(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"  data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ApprovalRejectTimesheetWeekly(this)" > </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName +
                                                '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year +
                                                '"  data-TimesheetMonth="' + full.TimeSheetMonth + '" data-TimesheetID="' + full.TimesheetID +
                                                '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '"  data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates +
                                                '"  data-TimesheetType="' + full.TimesheetType + '"  data-UProj_L1ManagerId="' + full.UProj_L1ManagerId +
                                                '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="WeeklyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"   data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="ApprovalRejectTimesheetWeekly(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"  data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ApprovalRejectTimesheetWeekly(this)" > </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName +
                                                '" data-userName="' + full.userName +
                                                '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                '" data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetMonth="' + full.TimesheetMonth +
                                                '" data-TimesheetID="' + full.TimesheetID +
                                                '" data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-AdminEmailid="' + full.AdminEmailid +
                                                '"  data-AdminName="' + full.AdminName +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '" data-ProjectId="' + full.ProjectId +
                                                '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }
                                            //return null;
                                        }
                                    if (full.TimesheetType == "Bi-Monthly") {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetID="' + full.TimesheetID +
                                                '"  data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '" data-ProjectId="' + full.ProjectId +
                                                '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId +
                                                '" data-ProjectName="' + full.ProjectName +
                                                '"  data-userName="' + full.userName +
                                                '"  data-TimesheetType="' + full.TimesheetType +
                                                '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                '" data-ByMonthlyDates="' + full.ByMonthlyDates + '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="ByMonthlyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)"  ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve" style="display: none"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"  data-Status="4" onclick="ManagerApprOrRej(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetID="' + full.TimesheetID +
                                                '"  data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '" data-ProjectId="' + full.ProjectId +
                                                '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId +
                                                '" data-ProjectName="' + full.ProjectName +
                                                '"  data-userName="' + full.userName +
                                                '"  data-TimesheetType="' + full.TimesheetType +
                                                '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                '" data-ByMonthlyDates="' + full.ByMonthlyDates + '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="ByMonthlyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)"  ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve" style="display: none"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"  data-Status="4" onclick="ManagerApprOrRej(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName +
                                                '" data-userName="' + full.userName +
                                                '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                '" data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetMonth="' + full.TimesheetMonth +
                                                '" data-TimesheetID="' + full.TimesheetID +
                                                '" data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-AdminEmailid="' + full.AdminEmailid +
                                                '"  data-AdminName="' + full.AdminName +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '" data-ProjectId="' + full.ProjectId +
                                                '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }
                                    }
                                        else {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '"  data-ProjectId="' + full.ProjectId + '" data-UProj_L1ManagerId="' + full.UProj_L1ManagerId +
                                                '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName +
                                                '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '"  data-TimesheetType="' + full.TimesheetType +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="PreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"    data-ProjectId="' + full.ProjectId + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"  data-Status="3"  title="Preview" onclick="ApprovalRejectTimesheet(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ApprovalRejectTimesheet(this)" > </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '"  data-ProjectId="' + full.ProjectId + '" data-UProj_L1ManagerId="' + full.UProj_L1ManagerId +
                                                '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName +
                                                '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '"  data-TimesheetType="' + full.TimesheetType +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="PreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"    data-ProjectId="' + full.ProjectId + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"  data-Status="3"  title="Preview" onclick="ApprovalRejectTimesheet(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ApprovalRejectTimesheet(this)" > </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName +
                                                '" data-userName="' + full.userName +
                                                '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                '" data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimesheetMonth +
                                                '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-AdminEmailid="' + full.AdminEmailid + '"  data-AdminName="' + full.AdminName +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId +
                                                '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }
                                        }


                                }
                                else {

                                        if (full.TimesheetType == "Bi-Weekly") {
                                            if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                                return '<a class="btn btn-icn"    id="PreviewManager" data-ProjectName="' + full.ProjectName +
                                                    '"  data-userName="' + full.userName +
                                                    '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                    '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                    '"  data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimeSheetMonth +
                                                    '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID +
                                                    '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                    '"  data-TimesheetType="' + full.TimesheetType + '" data-ProjectId="' + full.ProjectId +
                                                    '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"   data-UProj_L1ManagerId="' + full.UProj_L1ManagerId + '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="ByWeeklyPreviewManagerSubmitTimesheet(this,' + full.ProjectId + ')" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  title="Preview" onclick="ManagerApprOrRejByWeekly(this)" ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4"  onclick="ManagerApprOrRejByWeekly(this)" ><i id="RejectId" style="display: none" title="Reject" class="fa fa-times" ></i> </a>';
                                            } else {
                                                return '<a class="btn btn-icn"    id="PreviewManager" data-ProjectName="' + full.ProjectName +
                                                    '"  data-userName="' + full.userName +
                                                    '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                    '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                    '"  data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimeSheetMonth +
                                                    '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID +
                                                    '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                    '"  data-TimesheetType="' + full.TimesheetType + '" data-ProjectId="' + full.ProjectId +
                                                    '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"   data-UProj_L1ManagerId="' + full.UProj_L1ManagerId + '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="ByWeeklyPreviewManagerSubmitTimesheet(this,' + full.ProjectId + ')" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  title="Preview" onclick="ManagerApprOrRejByWeekly(this)" ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4"  onclick="ManagerApprOrRejByWeekly(this)" ><i id="RejectId" style="display: none" title="Reject" class="fa fa-times" ></i> </a>'
                                                    + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName + '" data-userName="' + full.userName +
                                                    '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                    '" data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimesheetMonth +
                                                    '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-AdminEmailid="' + full.AdminEmailid +
                                                    '"  data-AdminName="' + full.AdminName + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                    '" data-ProjectId="' + full.ProjectId + '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                            }
                                        }

                                    if (full.TimesheetType == "Weekly") {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName +
                                                '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                '"  data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimeSheetMonth +
                                                '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '"  data-TimesheetType="' + full.TimesheetType + '" data-ProjectId="' + full.ProjectId +
                                                '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"   data-UProj_L1ManagerId="' + full.UProj_L1ManagerId + '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="WeeklyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="ManagerApprOrRejWeekly(this)" ><i id="ApproveID" style="display: none"  class="fa fa-check" title="Approve"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ManagerApprOrRejWeekly(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName +
                                                '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                '"  data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimeSheetMonth +
                                                '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '"  data-TimesheetType="' + full.TimesheetType + '" data-ProjectId="' + full.ProjectId +
                                                '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"   data-UProj_L1ManagerId="' + full.UProj_L1ManagerId + '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="WeeklyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="ManagerApprOrRejWeekly(this)" ><i id="ApproveID" style="display: none"  class="fa fa-check" title="Approve"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ManagerApprOrRejWeekly(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName + '" data-userName="' + full.userName +
                                                '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                '" data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimesheetMonth +
                                                '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-AdminEmailid="' + full.AdminEmailid + '"  data-AdminName="' + full.AdminName +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId +
                                                '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }
                                            //return null;
                                        }
                                    if (full.TimesheetType == "Bi-Monthly") {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '" data-ProjectId="' + full.ProjectId + '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId +
                                                '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName +
                                                '"  data-TimesheetType="' + full.TimesheetType + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="ByMonthlyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)"  ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve" style="display: none"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="4" onclick="ManagerApprOrRej(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '" data-ProjectId="' + full.ProjectId + '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId +
                                                '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName +
                                                '"  data-TimesheetType="' + full.TimesheetType + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="ByMonthlyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)"  ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve" style="display: none"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="4" onclick="ManagerApprOrRej(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName + '" data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimesheetMonth + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-AdminEmailid="' + full.AdminEmailid + '"  data-AdminName="' + full.AdminName + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }
                                    }
                                    else {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '"  data-UProj_L1ManagerId="' + full.UProj_L1ManagerId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '"  data-TimesheetType="' + full.TimesheetType + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="PreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"     data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)" ><i id="ApproveID" class="fa fa-check" title="Approve" style="display: none" ></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"  data-Status="4" onclick="ManagerApprOrRej(this)" style="display: none" ><i id="RejectId" title="Reject" class="fa fa-times", style="display: none"></i> </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '"  data-UProj_L1ManagerId="' + full.UProj_L1ManagerId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '"  data-TimesheetType="' + full.TimesheetType + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="PreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"     data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)" ><i id="ApproveID" class="fa fa-check" title="Approve" style="display: none" ></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"  data-Status="4" onclick="ManagerApprOrRej(this)" style="display: none" ><i id="RejectId" title="Reject" class="fa fa-times", style="display: none"></i> </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName + '" data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimesheetMonth + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-AdminEmailid="' + full.AdminEmailid + '"  data-AdminName="' + full.AdminName + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }
                                        }

                                    }
                                if ((full.TimesheetApprovalStatus == "Approved By Level_1 Manager") || (full.TimesheetApprovalStatus == "Approved By Level_2 Manager") || (full.TimesheetApprovalStatus == "Approved by Both Managers"))
                                {
                                    
                                    if (full.TimesheetType == "Bi-Weekly") {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year + '"  data-TimesheetMonth="' + full.TimeSheetMonth + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '"  data-TimesheetType="' + full.TimesheetType + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId + '" title="Preview" onclick="ByWeeklyPreviewManagerSubmitTimesheet(this,' + full.ProjectId + ')" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"   data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" title="Preview" onclick="ApprovalRejectTimesheetByWeekly(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"  data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ApprovalRejectTimesheetByWeekly(this)" > </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year + '"  data-TimesheetMonth="' + full.TimeSheetMonth + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '"  data-TimesheetType="' + full.TimesheetType + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId + '" title="Preview" onclick="ByWeeklyPreviewManagerSubmitTimesheet(this,' + full.ProjectId + ')" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"   data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" title="Preview" onclick="ApprovalRejectTimesheetByWeekly(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"  data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ApprovalRejectTimesheetByWeekly(this)" > </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName + '" data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimesheetMonth + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-AdminEmailid="' + full.AdminEmailid + '"  data-AdminName="' + full.AdminName + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '" data-TimesheetDuration="' + full.TimesheetDuration + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }

                                  }

                                    if (full.TimesheetType == "Weekly") {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year + '"  data-TimesheetMonth="' + full.TimeSheetMonth + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '"  data-TimesheetType="' + full.TimesheetType + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId + '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="WeeklyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"   data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="ApprovalRejectTimesheetWeekly(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"  data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ApprovalRejectTimesheetWeekly(this)" > </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year + '"  data-TimesheetMonth="' + full.TimeSheetMonth + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '"  data-TimesheetType="' + full.TimesheetType + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId + '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="WeeklyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"   data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="ApprovalRejectTimesheetWeekly(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"  data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ApprovalRejectTimesheetWeekly(this)" > </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName + '" data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimesheetMonth + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-AdminEmailid="' + full.AdminEmailid + '"  data-AdminName="' + full.AdminName + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }
                                     // return null;
                                  }
                                    if (full.TimesheetType == "Bi-Monthly") {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '"  data-TimesheetType="' + full.TimesheetType + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '"  title="Preview" onclick="ByMonthlyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '"   data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)"  ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve" style="display: none"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="4" onclick="ManagerApprOrRej(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '"  data-TimesheetType="' + full.TimesheetType + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '"  title="Preview" onclick="ByMonthlyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '"   data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)"  ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve" style="display: none"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="4" onclick="ManagerApprOrRej(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName + '" data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimesheetMonth + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-AdminEmailid="' + full.AdminEmailid + '"  data-AdminName="' + full.AdminName + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }
                                    }
                                  else {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-UProj_L2ManagerId="' + full.UProj_L2ManagerId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + '"  data-TimesheetType="' + full.TimesheetType + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" title="Preview" onclick="PreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"     data-Status="3"  title="Preview" onclick="ApprovalRejectTimesheet(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"  data-Status="4" onclick="ApprovalRejectTimesheet(this)" > </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-UProj_L2ManagerId="' + full.UProj_L2ManagerId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + '"  data-TimesheetType="' + full.TimesheetType + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" title="Preview" onclick="PreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"     data-Status="3"  title="Preview" onclick="ApprovalRejectTimesheet(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"  data-Status="4" onclick="ApprovalRejectTimesheet(this)" > </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName + '" data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimesheetMonth + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-AdminEmailid="' + full.AdminEmailid + '"  data-AdminName="' + full.AdminName + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }
                                      // return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-UProj_L1ManagerId="' + full.UProj_L1ManagerId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" title="Preview" onclick="PreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"    data-ProjectId="' + full.ProjectId + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-TotalMonthName="' + full.TotalMonthName + '"  data-Status="3"  title="Preview" onclick="ApprovalRejectTimesheet(this)" ></a><a class="btn btn-icn"    id="Rejecttimesheet"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '" data-Status="4" onclick="ApprovalRejectTimesheet(this)" > </a>';
                                  }



                                }

                                else if ((full.TimesheetApprovalStatus == "Approved By Level_1 Manager and Pending at Level_2 Manager") || (full.TimesheetApprovalStatus == "Waiting for Approval at Level_2 Manager"))
                                {
                                    if (full.TimesheetType == "Bi-Weekly")
                                    {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName +
                                                '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetMonth="' + full.TimeSheetMonth + '" data-TimesheetID="' + full.TimesheetID +
                                                '"  data-Usr_UserID="' + full.Usr_UserID + '"  data-TimesheetType="' + full.TimesheetType +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId +
                                                '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"   data-UProj_L2ManagerId="' + full.UProj_L1ManagerId +
                                                '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="ByWeeklyPreviewManagerSubmitTimesheet(this,' + full.ProjectId + ')" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="ManagerApprOrRejByWeekly(this)" ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ManagerApprOrRejByWeekly(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName +
                                                '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetMonth="' + full.TimeSheetMonth + '" data-TimesheetID="' + full.TimesheetID +
                                                '"  data-Usr_UserID="' + full.Usr_UserID + '"  data-TimesheetType="' + full.TimesheetType +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId +
                                                '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"   data-UProj_L2ManagerId="' + full.UProj_L1ManagerId +
                                                '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="ByWeeklyPreviewManagerSubmitTimesheet(this,' + full.ProjectId + ')" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="ManagerApprOrRejByWeekly(this)" ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ManagerApprOrRejByWeekly(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName +
                                                '" data-userName="' + full.userName +
                                                '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours +
                                                '" data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimesheetMonth +
                                                '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-AdminEmailid="' + full.AdminEmailid + '"  data-AdminName="' + full.AdminName +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '" data-ProjectId="' + full.ProjectId +
                                                '" data-TimesheetDuration="' + full.TimesheetDuration +
                                                '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }
                                     }
                                    if (full.TimesheetType == "Weekly") {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName +
                                                '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetMonth="' + full.TimeSheetMonth + '" data-TimesheetID="' + full.TimesheetID +
                                                '"  data-Usr_UserID="' + full.Usr_UserID + '"  data-TimesheetType="' + full.TimesheetType +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId +
                                                '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"   data-UProj_L2ManagerId="' + full.UProj_L1ManagerId +
                                                '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="WeeklyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  title="Preview" onclick="ManagerApprOrRejWeekly(this)" ><i style:display:none; id="ApproveID" style="display: none" class="fa fa-check" title="Approve" ></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ManagerApprOrRejWeekly(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager" data-ProjectName="' + full.ProjectName +
                                                '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetMonth="' + full.TimeSheetMonth + '" data-TimesheetID="' + full.TimesheetID +
                                                '"  data-Usr_UserID="' + full.Usr_UserID + '"  data-TimesheetType="' + full.TimesheetType +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId +
                                                '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '"   data-UProj_L2ManagerId="' + full.UProj_L1ManagerId +
                                                '"data-ClientprojectId="' + full.ClientprojectId + '" title="Preview" onclick="WeeklyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-Status="3" data-ProjectId="' + full.ProjectId + '" data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"  data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  title="Preview" onclick="ManagerApprOrRejWeekly(this)" ><i style:display:none; id="ApproveID" style="display: none" class="fa fa-check" title="Approve" ></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-ByMonthlyDates="' + full.ByMonthlyDates + '" data-TimesheetMonth="' + full.TimeSheetMonth + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="4" onclick="ManagerApprOrRejWeekly(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName +
                                                '" data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetMonth="' + full.TimesheetMonth + '" data-TimesheetID="' + full.TimesheetID +
                                                '" data-Usr_UserID="' + full.Usr_UserID + '" data-AdminEmailid="' + full.AdminEmailid +
                                                '"  data-AdminName="' + full.AdminName + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '" data-ProjectId="' + full.ProjectId + '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }
                                         //return null;

                                     }
                                    if (full.TimesheetType == "Bi-Monthly") {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '" data-ProjectId="' + full.ProjectId + '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId +
                                                '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName +
                                                '"  data-TimesheetType="' + full.TimesheetType + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ByMonthlyDates="' + full.ByMonthlyDates +
                                                '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="ByMonthlyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)"  ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve" style="display: none"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="4" onclick="ManagerApprOrRej(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID +
                                                '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '" data-ProjectId="' + full.ProjectId + '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId +
                                                '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName +
                                                '"  data-TimesheetType="' + full.TimesheetType + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-ByMonthlyDates="' + full.ByMonthlyDates +
                                                '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="ByMonthlyPreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)"  ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve" style="display: none"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="4" onclick="ManagerApprOrRej(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName +
                                                '" data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours +
                                                '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year +
                                                '" data-TimesheetMonth="' + full.TimesheetMonth + '" data-TimesheetID="' + full.TimesheetID +
                                                '" data-Usr_UserID="' + full.Usr_UserID + '" data-AdminEmailid="' + full.AdminEmailid +
                                                '"  data-AdminName="' + full.AdminName + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus +
                                                '" data-ProjectId="' + full.ProjectId + '" data-TimesheetDuration="' + full.TimesheetDuration +
                                                '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }
                                    }

                                     else {
                                        if (RoleCode == "HR Manager" || RoleCode == "Accounts") {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '"  data-TimesheetType="' + full.TimesheetType + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="PreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)"  ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve" style="display: none"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="4" onclick="ManagerApprOrRej(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>';
                                        } else {
                                            return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '"  data-UProj_L2ManagerId="' + full.UProj_L2ManagerId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '"  data-TimesheetType="' + full.TimesheetType + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"data-ClientprojectId="' + full.ClientprojectId + '"  title="Preview" onclick="PreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '"  data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)"  ><i id="ApproveID" style="display: none" class="fa fa-check" title="Approve" style="display: none"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"data-ClientprojectId="' + full.ClientprojectId + '"   data-Status="4" onclick="ManagerApprOrRej(this)" ><i id="RejectId" title="Reject" class="fa fa-times" style="display: none"></i> </a>'
                                                + '<a class="btn btn-icn" id="Revoketimesheet" data-ProjectName="' + full.ProjectName + '" data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetMonth="' + full.TimesheetMonth + '" data-TimesheetID="' + full.TimesheetID + '" data-Usr_UserID="' + full.Usr_UserID + '" data-AdminEmailid="' + full.AdminEmailid + '"  data-AdminName="' + full.AdminName + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '" data-TimesheetDuration="' + full.TimesheetDuration + '"data-ClientprojectId="' + full.ClientprojectId + '" data-Status="5" onclick="ApprovalRejectTimesheet(this)" ><i class="fa fa-rotate-right"></i> </a>';
                                        }

                                         //return '<a class="btn btn-icn"   id="PreviewManager"  data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '" data-ProjectId="' + full.ProjectId + '"  data-UProj_L1ManagerId="' + full.UProj_L1ManagerId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  title="Preview" onclick="PreviewManagerSubmitTimesheet(this)" ><i class="fa fa-eye"></i> </a><a class="btn btn-icn"   id="Accepttimesheet" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '"  data-TotalMonthName="' + full.TotalMonthName + '"     data-Status="3" title="Preview" onclick="ManagerApprOrRej(this)" ><i id="ApproveID" class="fa fa-check" title="Approve"></i> </a><a class="btn btn-icn"    id="Rejecttimesheet" data-ProjectName="' + full.ProjectName + '"  data-userName="' + full.userName + '" data-CompanyBillingHours="' + full.CompanyBillingHours + '" data-ResourceWorkingHours="' + full.ResourceWorkingHours + '" data-MonthYear="' + full.Month_Year + '" data-TimesheetID="' + full.TimesheetID + '"  data-Usr_UserID="' + full.Usr_UserID + '" data-TimesheetApprovalStatus="' + full.TimesheetApprovalStatus + '"  data-ProjectId="' + full.ProjectId + '" data-TotalMonthName="' + full.TotalMonthName + '"  data-Status="4" onclick="ManagerApprOrRej(this)" ><i id="RejectId" title="Reject" class="fa fa-times" ></i> </a>';



                                     }





                                }


                                else
                                {

                                   return '';
                                }






                            },

                        },

                    ],
                     dom: 'Bfrtip',
                     buttons: [
                             {
                                 extend: 'excelHtml5',
                                 buttonclass: 'btn btn-success',
                                 text: '<i class="fa fa-file-excel-o"></i>',
                                 title: 'Account Timesheet',
                                 exportOptions: {
                                     columns: [5,6,7,8,9,11,12]
                                 }
                             },


                    ],
                    'initComplete': function () {
                        this.api().columns([5,6]).every(function () {
                            
                            var column = this;
                            var select = $('<select class="form-control form-control-lg" id="Select_' + $("#table tfoot th:nth-child(" + Math.round(this[0][0] - 4) + ")").text() + '"><option value="">Select ' + $("#table tfoot th:nth-child(" + Math.round(this[0][0] - 4) + ")").text() + '</option></select>')
                                .appendTo($(column.footer()).empty())
                                .on('change', function () {
                                    var val = $.fn.dataTable.util.escapeRegex(
                                        $(this).val()
                                    );

                                    column
                                        .search(val ? '^' + val + '$' : '', true, false)
                                        .draw();
                                });

                            column.data().unique().sort().each(function (d, j) {
                                select.append('<option value="' + d + '">' + d + '</option>')
                            });
                        });
                    }
                });

                $("#min").datepicker({ dateFormat:'dd/mm/yyyy', onSelect: function () { table.draw(); }, changeMonth: true, changeYear: true });
                $("#max").datepicker({ dateFormat: 'dd/mm/yyyy', onSelect: function () { table.draw(); }, changeMonth: true, changeYear: true });
                $('#min, #max').change(function () {
                    table.draw();
                });
                /*if (RoleCode == "HR Manager" || RoleCode == "Accounts") {

                    $('a.btn-icn[id*="Revoketimesheet"]').hide();
                }*/

            },
            error: function (msg) {
                // alert(msg.responseText);
            }
        });
    }


</script>

<script>


    var TaskDetailsid = ''; var MonthTimesheet = ''; var tsuserid = '', AppRejectstatus = '';
    var cid = '';
    var loadFile = function (event) {
        var output = document.getElementById('imgLogo');

        output.src = URL.createObjectURL(event.target.files[0]);
        $('#imgLogo').show();
    };
    function EditUser(id) {

        $("#body_ClientDetails").attr("style", "display: table;");
        TimesheetID = id.getAttribute("data-TimesheetID");
        Tid = TimesheetID;
        MonthTimesheet = id.getAttribute("data-MonthYear");
        tsuserid = id.getAttribute("data-Usr_UserID");
        $("#divPreviewTimesheet").attr("style", "display: none;");
        $("#divEditTimesheetData .btn-app").attr("style", "display: none;");
        $("#divEditTimesheetData").attr("style", "display: block;");
        $('#loading-image').attr("style", "display: block;");
        cid = id.getAttribute("data-ClientprojectId");
        $.ajax({
            url: "/Timesheet/ViewSubmitedTimesheet",
            type: "GET",
            data: { TimesheetMonth: MonthTimesheet, TimesheetUserid: tsuserid, clientProjectid: cid, TimesheetID: TimesheetID },
            contentType: 'application/json; charset=utf-8',
            dataType: 'JSON',
            async: false,
            success: function (resultData) {

                resultDataArray = resultData.timeSheetDetails;
                resultDataArrayUploadimages = resultData.UploadTimesheetimage;
                LoadColoursonLeavesandHolidays(MonthTimesheet, tsuserid);
                ViewTimesheetByMonth(MonthTimesheet, resultDataArray);
                LoadPreviewTasklookups();
            },
            complete: function () {
                $('#loading-image').attr("style", "display: none;");
            }

        });
        LoadPreviewTaskData();
    }

    var Submittedtype = ""; var TaskLookupId = "", workingHours = "", Commentss = "";
    function ConfirmSendTimesheet(id) {

        var savetimesheetid = TimesheetID;
        var files = $("#flImage").get(0).files;
        var formData = new FormData();

        for (var i = 0; i < files.length; i++) {
            formData.append("fileInput", files[i]);
        }
        $.ajax({
            type: 'post',
            url: '/Timesheet/SaveToTemp',
            data: formData,
            success: function (response) {
                if (response != null) {
                    var my_path = "/temp/" + response;
                    var image = '<img src="' + my_path + '" alt="image" style="width:150px">';
                    $("#imgPreview").append(image);
                }
            },
            processData: false,
            contentType: false,
            error: function () {
                alert("Whoops something went wrong!");
            }
        });


        if (id == '1') {
            Submittedtype = 'Save';
        }
        if (id == '2') {

            Submittedtype = 'Submit';
        }

        Commentss = $.trim($("#txtDescription").val());



        var rows = $("#SubTable,#SubTable2").find("tr");

        var listtimesheetdetails = []; var rowData = {}; var Date, TaskId, hours;
        var satdates = [];
        for (var rowOn = 1; rowOn < rows.length; rowOn++) {

            TaskLookupId = $(rows[rowOn]).find('.lookup').attr('id');
            workingHours = $(rows[rowOn]).find('.uc1txtHours').attr('id');
            colourcode = $(rows[rowOn]).find('span').attr('title');
            Date = $(rows[rowOn]).find("td").eq(0).text();
            TaskId = $("#" + TaskLookupId).val();
            hours = $("#" + workingHours).val();

            if (hours == "") {
                if (!$.trim(this.value)) {
                    alert("Please enter working hours");
                    $(".uc1txtHours").focus();
                    calculateSum();
                    return false;
                }
            }

            if (hours != "") {
                if (hours < 0) {
                    alert("Working hours should be not be less than zero");
                    $("#" + workingHours).val('');
                    $("#uc1_txtHours").focus();
                    calculateSum();
                    return false;
                }
            }



            if (hours != "") {
                if (hours > 24) {
                    alert("Working hours should not be greater than 24 hours");
                    $("#" + workingHours).val('');
                    $("#uc1_txtHours").focus();
                    calculateSum();
                    return false;
                }
            }


            if ((colourcode == "blue" && colourcode != undefined) || (colourcode == "black" && colourcode != undefined) || (colourcode == "Red" && colourcode != undefined)) {

                if (hours > 0) {
                    satdates.push(Date);


                    hours = $("#" + workingHours).val();
                    calculateSum();




                }
            }



            if (rowOn != 17) {
                if (TaskId != undefined && hours != undefined && Date != null) {
                    rowData = { taskDate: Date, taskid: TaskId, hoursWorked: hours }
                }
            }
            else {
                continue;
            }

            listtimesheetdetails.push(rowData);
        }

        //alert("Do you want to fill holidaydate of " + satdates + " ?");
        if (satdates.length != 0) {
            if (confirm("Do you want to fill holidaydate of " + satdates + " ?")) {

                $("span[id^='HoursColours'][title='black']").closest('tr').removeClass("brown");

            } else {
                $("span[id^='HoursColours'][title='black']").closest('tr').addClass("brown");
                return false;
            }
        }


        var timesheets = {
            TimesheetID: TimesheetID,
            TimeSheetMonth: ByMonthlystartdate,
            ByWeeklyStartDate: ByMonthlystartdate,
            ByWeeklyEndDate: ByMonthlyenddate,
            Comments: Commentss,
            SubmittedType: Submittedtype,
            TimesheetMode: '3',

        }

        var sheetObj = {
            timesheets: timesheets,
            listtimesheetdetails: listtimesheetdetails

        };

        $('#loading-image').attr("style", "display: block;");
        $.ajax({
            type: "POST",
            url: "/Timesheet/updateTimesheetTaskDetails",
            data: JSON.stringify(sheetObj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                alert(data);
                window.location.reload();
            },
            complete: function () {
                $('#loading-image').attr("style", "display: none;");
            }
        });


    }

    function ViewTimesheetByMonth(MonthTimesheet, resultData) {
        $("#body_ClientDetails").attr("style", "display: table;");
        $("#btnPrint").hide();
        $("#btnpdf").hide();
        $("#btnShare").hide();
        $("#tabCon").empty();
        $("#MainTable").empty();
        $("#SubTable").empty();
        // $("#flImage").show();
        $("#imagelbl").show();
        $("#images").show();
        $("#Timesheet_dvTSMode").html("Monthly");
        var tbltask = ''; var objSelect = '';
        $('#Cmtsave').show();
        var counter = -1;
        var counter15 = -1;
        $("#ClientDetails2").show(true);
        $("#tabCon").append("<table name='maintbl' id='MainTable' width='100%'/*style='position:relative;left:10%;'*/>");

        $.each(resultData, function (k, v) {

            $("#StardateToEnddate").html("<span id='StartToEnd'><b>Timesheet of " + v.UserName + " for the Period of " + v.TotalMonthName + "</b></span>");
            $("#txtDescription").val(v.Comments);
            $('#ts_ManagerNamesid1').html(v.ManagerName1);
            $("#Timesheet_Duration").html(v.TotalMonthName);
            if (v.ManagerName2 != '0') {
                $('#ts_ManagerNamesid2').html(v.ManagerName2);
                $("b.ts_ManagerNamesid2").show();
                $("#ts_Manager2").show();
                //$('#ts_ManagerNamesid2').closest("b.ts_ManagerNamesid2").show();
            }
            else {
                $('#ts_ManagerNamesid2').html("");
                $("b.ts_ManagerNamesid2").hide();
                $("#ts_Manager2").hide();
            }
            $("#ts_Approveid").hide();
            $("#ts_Submittedid").hide();
            $("#ts_approid").hide();
            $("#ts_submited").hide();

            if (k <= 15) {
                tbltask = 'uc1_ddlTask' + k;
                if (counter15 == -1) {

                    $("#MainTable").append("<td id='td1'>" +
                        "<table id='SubTable' width='100%' class='evAdminTable1'><tr style='background-color:black;color:white'><th width='160' text-align='center' class='evAdminTable'>Date </th> <th class='evAdminTable'>Task </th> <th width='50' class='evAdminTable'>Hours </th></tr>");

                }

                //$("#SubTable").append("<tr><td>" + v.MonthYearName + "</td><td><select id='uc1_ddlTask" + k + "' class='form-control lookup' selected  ></select></td><td><input class='form-control uc1txtHours' name='hrs' type='number' title='Enter hours' maxlength='2'  min='0' max='8' id='uc1_txtHours" + k + "' value=" + v.NoofHoursWorked + "  style='width: 50px;'></td><td >&nbsp</td></td>");
                $("#SubTable").append("<tr><td>" + v.MonthYearName + "</td><td><select id='uc1_ddlTask" + k + "' class='form-control lookup' selected  ></select></td><td><div class='flex'><input class='form-control uc1txtHours' name='hrs' type='number' title='Enter hours' min='0' max='24' maxlength='2' id='uc1_txtHours" + k + "' value=" + v.NoofHoursWorked + "  style='width: 56px;'><span id='HoursColours" + k + "'  title=" + v.colour + " style='display: none;font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td><td >&nbsp</td></td>");
                counter15 = counter15 + 1;


            }
            else {

                tbltask = 'uc1_ddlTask' + k;
                if (counter == -1) {
                    $("#SubTable").append("</table>")
                    $("#SubTable").append("</td>")
                    $("#MainTable").append("<td id='td2'><table id='SubTable2' /*style='position:relative;top:19px;'*/ width='100%' class='evAdminTable1'><tr style='background-color:black;color:white'><th width='160' text-align='center' class='evAdminTable'>Date </th> <th class='evAdminTable'>Task </th> <th width='50'class='evAdminTable'>Hours</th></tr>");
                }

                $("#SubTable2").append("<tr><td>" + v.MonthYearName + "</td><td><select id='uc1_ddlTask" + k + "' class='form-control lookup' selected  ></select></td><td><div class='flex'><input class='form-control uc1txtHours' name='hrs' type='number' title='Enter hours' min='0' max='24' maxlength='2' id='uc1_txtHours" + k + "' value=" + v.NoofHoursWorked + "  style='width: 56px;'><span id='HoursColours" + k + "'  title=" + v.colour + " style='display: none;font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td><td >&nbsp</td></td>");
                // $('#uc1_ddlTask' + k).append('<option value="' + v.Taskid + '">' + v.Taskname + '</option>');
                counter = counter + 1;

            }

        });
        HoursDataColoursPreview();
        calculateSum();
        $(":input").bind('keyup mouseup', function () {
            calculateSum();

        });
        if (resultDataArrayUploadimages.length == 0) {
            $("#images,#previewFlImage,#imagestwo,#previewFlImage1").hide();
        }
        else if (resultDataArrayUploadimages.length == 1) {
            var url;
            url = "/TimeSheetimages/" + resultDataArrayUploadimages[0].Uploadedimages;
            if (url !== null && url !== "") {
                $("#images").show();
                $('#previewFlImage').prop('src', url);
                $("#imagestwo,#previewFlImage1").hide();
            } else {
                $("#images,#previewFlImage").hide();
            }

        }
        else {

            $.each(resultDataArrayUploadimages, function (k, v) {
                
                var url;
                if (k == 0) {
                    url = "/TimeSheetimages/" + v.Uploadedimages;
                    if (url !== null && url !== "") {
                        $("#images").show();
                        $('#previewFlImage').prop('src', url);
                    } else {
                        $("#images,#previewFlImage").hide();
                    }
                }
                else {
                    url = "/TimeSheetimages/" + v.Uploadedimages;
                    if (url !== null && url !== "") {
                        $("#imagestwo").show();
                        $('#previewFlImage1').prop('src', url);
                    } else {
                        $("#imagestwo,#previewFlImage1").hide();
                    }
                }

            });
        }
        //$.each(resultDataArrayUploadimages, function (k, v) {
        //    var url = "/TimeSheetimages/" + v.Uploadedimages;

        //    if (url !== null && url !== "") {
        //        $('#imgLogo').show();
        //        $("#images").show();
        //        //$('#imgLogo').prop('src', url);
        //        $('#previewFlImage').prop('src', url);
        //        //$("#images").append("<img id='imgModal_" + v.Attachmentid + "' src='" + url + "' class='img-responsive' data-toggle='modal' data-target='#imgModal' style='display:inline-block' alt='Logo' width='150' height='55' />");
        //        //$("#images > img#imgModal_" + v.Attachmentid + ".img-responsive[data-toggle='modal']").on('click', function () {
        //        //    var image = $(this).attr('src');
        //        //    
        //        //    console.log(image);
        //        //    $('#imgModal').on('show.bs.modal', function () {
        //        //        $(".showimage").attr('src', image);
        //        //    });
        //        //});
        //    }


        //});

        "</table>" + + "<hr />"
        $("#MainTable").append("</tr></table>") + "<hr />";

    }

    var Tid;

    function PreviewSubmitTimesheet(id) {
        
        $("#body_ClientDetails").attr("style", "display: table;");
        $("#btnPrint").show();
        $("#btnpdf").show();
        $("#btnShare").show();
        $("#tabCon").empty();
        $("#MainTable").empty();
        $("#SubTable").empty();
        $("#Timesheet_dvTSMode").html("Monthly");
        $("#Timesheet_dvTSMode").html(id.getAttribute("data-TimesheetType"))
        //LoadClientDetails();
        //$("#ClientDetails2").show(true);
        TimesheetID = id.getAttribute("data-TimesheetID");
        Tid = TimesheetID;
        MonthTimesheet = id.getAttribute("data-MonthYear");
        AppRejectstatus = id.getAttribute("data-TimesheetApprovalStatus");
        cid = id.getAttribute("data-ClientprojectId");
        empprojectname = id.getAttribute("data-ProjectName");
        empname = id.getAttribute("data-userName");
        empactualhrs = id.getAttribute("data-CompanyBillingHours");
        empworkedhrs = id.getAttribute("data-ResourceWorkingHours");
        attchemntid = id.getAttribute("data-attachId");
        uploadedImage = id.getAttribute("data-UpImage");
        $("#divEditTimesheetData .btn-app").attr("style", "display: none;");
        $("#divPreviewTimesheet").attr("style", "display: none;");
        $("#divEditTimesheetData").attr("style", "display: block;");
        tsuserid = id.getAttribute("data-Usr_UserID");
        $('#loading-image').attr("style", "display: block;");
        $.ajax({
            url: "/Timesheet/ViewSubmitedTimesheet",
            type: "GET",
            data: { TimesheetMonth: MonthTimesheet, TimesheetUserid: tsuserid, clientProjectid: cid, TimesheetID: TimesheetID },
            contentType: 'application/json; charset=utf-8',
            dataType: 'JSON',
            async: false,
            // cache: false,

            success: function (resultData) {

                resultDataArray = resultData.timeSheetDetails;
                resultDataArrayUploadimages = resultData.UploadTimesheetimage;
                LoadColoursonLeavesandHolidays(MonthTimesheet, tsuserid);
                PreviewTimesheetsByMonth(MonthTimesheet, resultDataArray);
                LoadPreviewTasklookups();
            }
            , complete: function () {
                $('#loading-image').attr("style", "display: none;");
            }

        });
        LoadData();
    }


    function PreviewTimesheetsByMonth(MonthTimesheet, resultData) {

        $("#images").show();
        $("#tabCon").empty();
        $("#MainTable").empty();
        $("#SubTable").empty();
        var tbltask = ''; var objSelect = '';
        $('#Cmtsave').show();
        $("#ClientDetails2").show(true);
        var counter = -1;
        var counter15 = -1;

        $("#tabCon").append("<table name='maintbl' id='MainTable' width='100%' /*style='position:relative;left:10%;'*/>");


        $.each(resultData, function (k, v) {

            $("#txtDescription").html(v.Comments);
            $("#Timesheet_Duration").html(v.TotalMonthName);
            if (v.ApprovedDate != '') {
                $("#ts_Approveid").html(v.ApprovedDate);
                $("#ts_approid").show();
            }
            else {
                $("#ts_Approveid").hide(v.ApprovedDate);
                $("#ts_approid").hide();
            }

            $("#ts_Submittedid").html(v.SubmittedDate);
            $("#ts_submited").show();
            $('#ts_ManagerNamesid1').html(v.ManagerName1);
            if (v.ManagerName2 != '0') {
                $('#ts_ManagerNamesid2').html(v.ManagerName2);
                $("b.ts_ManagerNamesid2").show();
                $("#ts_Manager2").show();
            }
            else {
                $("#ts_ManagerNamesid2").hide();
                $('#ts_ManagerNamesid2').html("");
                $("#ts_Manager2").hide();
            }
            
            //if (v.Submitted_Type == 0) {
            //    $("#TimesheetApprovalStatus").html("Reject");
            //}
            //else if (v.Submitted_Type == 1 && v.L1_ApproverStatus == 0 && v.L2_ApproverStatus == 0) {
            //    $("#TimesheetApprovalStatus").html("Waiting for both Managers");

            //}
            //else if (v.Submitted_Type == 0 && v.L1_ApproverStatus == 1 && v.L2_ApproverStatus ==0) {
            //    $("#TimesheetApprovalStatus").html("Approved By" + v.ManagerName1 + "Pending at" + v.ManagerName2);
            //}
            //else {
            //    $("#TimesheetApprovalStatus").html("Approved by both Managers");

            //}
            $("#StardateToEnddate").html("<span id='StartToEnd'><b>Timesheet of " + v.UserName + " for the Period of " + v.TotalMonthName + "</b></span>");

            if (v.Submitted_Type == 1 && v.L1_ApproverStatus == 1 && v.L2_ApproverStatus == 1) {
                $("#UserStatus").html("Approved by both Managers").css("color", "Green");
            }
            else if (v.Submitted_Type == 1 && v.L1_ApproverStatus == 1 && v.L2_ApproverStatus == 0) {
                $("#UserStatus").html("Approved by " + v.ManagerName1).css("color", "Green");
            }

            else if (v.Submitted_Type == 1 && v.L1_ApproverStatus == 0 && v.L2_ApproverStatus == 0) {

                $("#UserStatus").html("Waiting for both Managers").css("color", "deepskyblue");

            }
            else if (v.Submitted_Type == 0 && v.L1_ApproverStatus == 1 && v.L2_ApproverStatus == 0) {
                $("#UserStatus").html("Approved By " + v.ManagerName1 + " Pending at " + v.ManagerName2).css("color", "#6e3400");
            }
            else if (v.Submitted_Type == 0 && v.L1_ApproverStatus == 0 && v.L2_ApproverStatus == 2) {
                $("#UserStatus").html("Reject/Revoke By " + v.ManagerName2).css("color", "Red");
            }
            else {

                $("#UserStatus").html("Reject/Revoke").css("color", "Red");
            }
            if (k <= 15) {
                tbltask = 'uc1_ddlTask' + k;
                if (counter15 == -1) {

                    $("#MainTable").append("<td id='td1'>" +
                        "<table id='SubTable' width='100%' class='evAdminTable1'><tr style='background-color:black;color:white'><th width='160' text-align='center' class='evAdminTable'>Date </th> <th class='evAdminTable'>Task </th> <th width='50' class='evAdminTable'>Hours </th></tr>");

                }
                $("#SubTable").append("<tr><td class='colored'>" + v.MonthYearName + "</td><td class='colored' id='uc1_ddlTask" + k + "'>" + v.Taskname + "</td><div class='flex'><td class='colored' name='uc1txtHours'  id='uc1_txtHours" + k + "'><font>" + v.NoofHoursWorked + "</font><span id='HoursColours" + k + "'  title=" + v.colour + " style='display: none;font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td></td>");
                //   $("#SubTable").append("<tr><td>" + v.MonthYearName + "</td><td><select id='uc1_ddlTask" + k + "' class='form-control lookup' selected  ></select></td><td><div class='flex'><input class='form-control uc1txtHours' name='hrs' type='number' title='Enter hours' min='0' max='24' maxlength='2' id='uc1_txtHours" + k + "' readonly value=" + v.NoofHoursWorked + "  style='width: 56px;'><span id='HoursColours" + k + "' style='font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td><td >&nbsp</td></td>");


                counter15 = counter15 + 1;

            }
            else {
                tbltask = 'uc1_ddlTask' + k;
                if (counter == -1) {
                    $("#SubTable").append("</table>")
                    $("#SubTable").append("</td>")
                    $("#MainTable").append("<td id='td2'><table id='SubTable2' /*style='position:relative;top:19px;'*/ width='100%' class='evAdminTable1'><tr style='background-color:black;color:white'><th width='160' text-align='center' class='evAdminTable'>Date </th> <th class='evAdminTable'>Task </th> <th width='50'class='evAdminTable'>Hours</th></tr>");
                }
                $("#SubTable2").append("<tr><td class='colored'>" + v.MonthYearName + "</td><td class='colored' id='uc1_ddlTask" + k + "'>" + v.Taskname + "</td><div class='flex'><td class='colored' name='uc1txtHours'  id='uc1_txtHours" + k + "'><font>" + v.NoofHoursWorked + "</font><span id='HoursColours" + k + "' title=" + v.colour + " style='display: none;font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td></td>");
                // $("#SubTable2").append("<tr><td>" + v.MonthYearName + "</td><td><select id='uc1_ddlTask" + k + "' class='form-control lookup' selected  ></select></td><td><div class='flex'><input class='form-control uc1txtHours' name='hrs' type='number' title='Enter hours' min='0' max='24' maxlength='2' id='uc1_txtHours" + k + "' readonly value=" + v.NoofHoursWorked + "  style='width: 56px;'><span id='HoursColours" + k + "' style='font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td><td >&nbsp</td></td>");
                counter = counter + 1;

            }

            //$("#MainTable").append(v.Uploadedimages);



        });


        HoursDataColoursPreview();
        CalculatePreview();
        "</table>" + + "<hr />";
        $("#MainTable").append("</tr></table>") + "<hr />";
        $('table[id="SubTable"] tr > td:last-child').css("display", "table-cell");
        $('table[id="SubTable2"] tr > td:last-child').css("display", "table-cell");
        if (resultDataArrayUploadimages.length == 0) {
            
            $("#images,#previewFlImage,#imagestwo,#previewFlImage1").hide();
        }
        else if (resultDataArrayUploadimages.length == 1) {
            
            var url;
            url = "/TimeSheetimages/" + resultDataArrayUploadimages[0].Uploadedimages;
            if (url !== null && url !== "") {
                $("#images").show();
                $('#previewFlImage').prop('src', url);
                $("#imagestwo,#previewFlImage1").hide();
            } else {
                $("#images,#previewFlImage").hide();
            }

        }
        else {

            $.each(resultDataArrayUploadimages, function (k, v) {

                
                var url;
                if (k == 0) {
                    url = "/TimeSheetimages/" + v.Uploadedimages;
                    if (url !== null && url !== "") {
                        $("#images").show();
                        $('#previewFlImage').prop('src', url);
                    } else {
                        $("#images,#previewFlImage").hide();
                    }
                }
                else {
                    url = "/TimeSheetimages/" + v.Uploadedimages;
                    if (url !== null && url !== "") {
                        $("#imagestwo").show();
                        $('#previewFlImage1').prop('src', url);
                    } else {
                        $("#imagestwo,#previewFlImage1").hide();
                    }
                }

            });
        }
        //$.each(resultDataArrayUploadimages, function (k, v) {
        //    var url = "/TimeSheetimages/" + v.Uploadedimages;

        //    if (url !== null && url !== "") {
        //        $('#imgLogo').show();
        //        $("#images").show();
        //        $('#previewFlImage').prop('src', url);
        //        //   $('#imgLogo').prop('src', url);
        //        //$("#images").append("<img id='imgModal_" + v.Attachmentid + "' src='" + url + "' class='img-responsive' data-toggle='modal' data-target='#imgModal' style='display:inline-block' alt='Logo' width='150' height='55' />");
        //        //$("#images > img#imgModal_" + v.Attachmentid + ".img-responsive[data-toggle='modal']").on('click', function () {
        //        //    var image = $(this).attr('src');
        //        //    
        //        //    console.log(image);
        //        //    $('#imgModal').on('show.bs.modal', function () {
        //        //        $("img#showimage.showimage").attr("src", image);
        //        //    });
        //        //});
        //    }


        //});

    }


    function PreviewManagerSubmitTimesheet(id) {
        
        console.log(id.getAttribute("data-TimesheetType"));
        //window.location.href = "/Timesheet/timesheetdata/";
        $("#table").closest(".clearfix.table-block").attr("style", "display: none;");
        $("#body_ClientDetails").attr("style", "display: table;");
        $("#btnPrint").show();
        $("#btnpdf").show();
        $("#btnShare").show();
        $("#tabCon").empty();
        $("#MainTable").empty();
        $("#SubTable").empty();
        var timesheetmode = id.getAttribute("data-TimesheetType");
        $("#Timesheet_dvTSMode").html(id.getAttribute("data-TimesheetType"))
        //$("#Timesheet_dvTSMode").html(timesheetmode);
        //LoadClientDetails();
        //$("#ClientDetails2").show(true);
        TimesheetID = id.getAttribute("data-TimesheetID");
        Tid = TimesheetID;
        MonthTimesheet = id.getAttribute("data-MonthYear");
        AppRejectstatus = id.getAttribute("data-TimesheetApprovalStatus");
        cid = id.getAttribute("data-ClientprojectId");
        empprojectname = id.getAttribute("data-ProjectName");
        empname = id.getAttribute("data-userName");
        empactualhrs = id.getAttribute("data-CompanyBillingHours");
        empworkedhrs = id.getAttribute("data-ResourceWorkingHours");

        $("#divEditTimesheetData .btn-app").attr("style", "display: none;");
        $("#divPreviewTimesheet").attr("style", "display: none;");
        $("#divEditTimesheetData").attr("style", "display: block;");
        tsuserid = id.getAttribute("data-Usr_UserID");
        ApporRejprojectid = id.getAttribute("data-ProjectId");
        var myvariable = $('#UserGridData a').attr('id');
        var myManagerGridData = $('#ManagerGridData a').attr('id');
        var L1Managerid = id.getAttribute("data-UProj_L1ManagerId");
        var L2Managerid = id.getAttribute("data-UProj_L2ManagerId");

        if (myManagerGridData) {
            if (L1Managerid) {
                if ((AppRejectstatus == "Approved By Level_1 Manager") || (AppRejectstatus == "Approved By Level_2 Manager")
                    || (AppRejectstatus == "Approved By Level_1 Manager and Pending at Level_2 Manager") || (AppRejectstatus == "Pending at Level_1 Manager and Approved by Level_2 Manager")
                    || (AppRejectstatus == "Approved by Both Managers")) {

                    $("#btnApprove").attr("style", "display:none;");
                    $("#btnReject").attr("style", "display:none;");

                }

                else {
                    $("#btnApprove").attr("style", "display: inline-block;");
                    $("#btnReject").attr("style", "display: inline-block;");
                }
            }

            if (L2Managerid) {

                if ((AppRejectstatus == "Approved By Level_1 Manager") || (AppRejectstatus == "Approved By Level_2 Manager")
                    //|| (AppRejectstatus == "Approved By Level_1 Manager and Pending at Level_2 Manager") || (AppRejectstatus == "Pending at Level_1 Manager and Approved by Level_2 Manager")
                    || (AppRejectstatus == "Approved by Both Managers")) {

                    $("#btnApprove").attr("style", "display:none;");
                    $("#btnReject").attr("style", "display:none;");

                }

                else {
                    $("#btnApprove").attr("style", "display: inline-block;");
                    $("#btnReject").attr("style", "display: inline-block;");
                }
            }

        }
        $('#loading-image').attr("style", "display: block;");
        $.ajax({
            url: "/Timesheet/ViewSubmitedTimesheet",
            type: "GET",
            data: { TimesheetMonth: MonthTimesheet, TimesheetUserid: tsuserid, clientProjectid: cid, TimesheetID: TimesheetID },
            contentType: 'application/json; charset=utf-8',
            dataType: 'JSON',
            async: false,
            success: function (resultData) {
                
                resultDataArray = resultData.timeSheetDetails;
                resultDataArrayUploadimages = resultData.UploadTimesheetimage;
                LoadColoursonLeavesandHolidays(MonthTimesheet, tsuserid);
                PreviewTimesheetsByMonth(MonthTimesheet, resultDataArray);

                LoadTasklookupsByUser(tsuserid);
            },
            complete: function () {
                $('#loading-image').attr("style", "display: none;");
            }


        });
        LoadManagerData();

    }


    function WeeklyPreviewManagerSubmitTimesheet(id) {
        
        $("#table").closest(".clearfix.table-block").attr("style", "display: none;");
        $("#body_ClientDetails").attr("style", "display: table;");
        $("#btnPrint").show();
        $("#btnpdf").show();
        $("#btnShare").show();
        $("#tabCon").empty();
        $("#MainTable").empty();
        $("#SubTable").empty();
        TimesheetID = id.getAttribute("data-TimesheetID");
        Tid = TimesheetID;
        MonthTimesheet = id.getAttribute("data-MonthYear");
        AppRejectstatus = id.getAttribute("data-TimesheetApprovalStatus");
        ByMonthlydates = id.getAttribute("data-ByMonthlyDates");
        empprojectname = id.getAttribute("data-ProjectName");
        empname = id.getAttribute("data-userName");
        empactualhrs = id.getAttribute("data-CompanyBillingHours");
        empworkedhrs = id.getAttribute("data-ResourceWorkingHours");
        cid = id.getAttribute("data-ClientprojectId");
        var Timesheetmonarray5 = new Array();
        Timesheetmonarray5 = ByMonthlydates.split("-");
        $("#divEditTimesheetData .btn-app").attr("style", "display: none;");
        $("#divPreviewTimesheet").attr("style", "display: none;");
        $("#divEditTimesheetData").attr("style", "display: block;");
        tsuserid = id.getAttribute("data-Usr_UserID");
        ApporRejprojectid = id.getAttribute("data-ProjectId");
        var myvariable = $('#UserGridData a').attr('id');
        var myManagerGridData = $('#ManagerGridData a').attr('id');
        var L1Managerid = id.getAttribute("data-UProj_L1ManagerId");
        var L2Managerid = id.getAttribute("data-UProj_L2ManagerId");
        var AID = $("#accid").val();
        var PID = $("#PrjId").val();
        TimesheetMonth = Timesheetmonarray5[1];
        ByMonthlystartdate = Timesheetmonarray5[0]; ByMonthlyenddate = Timesheetmonarray5[1];

        if (myManagerGridData) {
            if (L1Managerid) {
                if ((AppRejectstatus == "Approved By Level_1 Manager") || (AppRejectstatus == "Approved By Level_2 Manager")
                    || (AppRejectstatus == "Approved By Level_1 Manager and Pending at Level_2 Manager") || (AppRejectstatus == "Pending at Level_1 Manager and Approved by Level_2 Manager")
                    || (AppRejectstatus == "Approved by Both Managers")) {

                    $("#btnApprove").attr("style", "display:none;");
                    $("#btnReject").attr("style", "display:none;");

                }

                else {
                    $("#btnApprove").attr("style", "display: inline-block;");
                    $("#btnReject").attr("style", "display: inline-block;");
                }
            }

            if (L2Managerid) {
                if ((AppRejectstatus == "Approved By Level_1 Manager") || (AppRejectstatus == "Approved By Level_2 Manager")
                    //|| (AppRejectstatus == "Approved By Level_1 Manager and Pending at Level_2 Manager") || (AppRejectstatus == "Pending at Level_1 Manager and Approved by Level_2 Manager")
                    || (AppRejectstatus == "Approved by Both Managers")) {

                    $("#btnApprove").attr("style", "display:none;");
                    $("#btnReject").attr("style", "display:none;");

                }

                else {
                    $("#btnApprove").attr("style", "display: inline-block;");
                    $("#btnReject").attr("style", "display: inline-block;");
                }
            }

        }
        $('#loading-image').attr("style", "display: block;");
        $.ajax({
            url: "/Timesheet/ViewByWeeklySubmitedTimesheet",
            type: "GET",
            data: {
                TimesheetUserid: tsuserid, Timesheetstartdate: Timesheetmonarray5[0],
                TimesheetEnddate: Timesheetmonarray5[1],
                Accountid: AID, Projectid: ApporRejprojectid, clientProjectid: cid
            },
            contentType: 'application/json; charset=utf-8',
            dataType: 'JSON',
            async: false,
            success: function (resultData) {
                
                resultDataArray = resultData.timeSheetDetails;
                resultDataArrayUploadimages = resultData.UploadTimesheetimage;
                PreviewByMonthlyLoadHoursWorkedAcctoDate(tsuserid, Timesheetmonarray5[0], Timesheetmonarray5[1], AID, PID);
                PreviewTimesheetsWeekly(Timesheetmonarray5[1], resultDataArray);
                LoadTasklookupsByUser(tsuserid);
            },
            complete: function () {
                $('#loading-image').attr("style", "display: none;");
            }


        });
        LoadManagerData();

    }

    function ByWeeklyPreviewManagerSubmitTimesheet(id, proj_id) {
        
        $("#table").closest(".clearfix.table-block").attr("style", "display: none;");
        $("#body_ClientDetails").attr("style", "display: table;");
        $("#Timesheet_dvTSMode").html("Bi-Weekly");
        $("#btnPrint").show();
        $("#btnpdf").show();
        $("#btnShare").show();
        $("#tabCon").empty();
        $("#MainTable").empty();
        $("#SubTable").empty();

        TimesheetID = id.getAttribute("data-TimesheetID");
        Tid = TimesheetID;
        MonthTimesheet = id.getAttribute("data-MonthYear");
        AppRejectstatus = id.getAttribute("data-TimesheetApprovalStatus");
        ByMonthlydates = id.getAttribute("data-ByMonthlyDates");
        empprojectname = id.getAttribute("data-ProjectName");
        empname = id.getAttribute("data-userName");
        empactualhrs = id.getAttribute("data-CompanyBillingHours");
        empworkedhrs = id.getAttribute("data-ResourceWorkingHours");
        cid = id.getAttribute("data-ClientprojectId");
        var Timesheetmonarray5 = new Array();
        Timesheetmonarray5 = ByMonthlydates.split("-");
        $("#divEditTimesheetData .btn-app").attr("style", "display: none;");
        $("#divPreviewTimesheet").attr("style", "display: none;");
        $("#divEditTimesheetData").attr("style", "display: block;");
        tsuserid = id.getAttribute("data-Usr_UserID");
        ApporRejprojectid = id.getAttribute("data-ProjectId");
        var myvariable = $('#UserGridData a').attr('id');
        var myManagerGridData = $('#ManagerGridData a').attr('id');
        var L1Managerid = id.getAttribute("data-UProj_L1ManagerId");
        var L2Managerid = id.getAttribute("data-UProj_L2ManagerId");
        var AID = $("#accid").val();
        var PID = $("#PrjId").val();
        TimesheetMonth = Timesheetmonarray5[1];
        ByMonthlystartdate = Timesheetmonarray5[0]; ByMonthlyenddate = Timesheetmonarray5[1];


        $('#loading-image').attr("style", "display: block;");
        $.ajax({
            url: "/Timesheet/ViewByWeeklySubmitedTimesheet",
            type: "GET",
            data: {
                TimesheetUserid: tsuserid, Timesheetstartdate: Timesheetmonarray5[0],
                TimesheetEnddate: Timesheetmonarray5[1],
                Accountid: AID, Projectid: proj_id,
                clientProjectid: cid
            },
            contentType: 'application/json; charset=utf-8',
            dataType: 'JSON',
            async: false,
            success: function (resultData) {
                resultDataArray = resultData.timeSheetDetails;
                resultDataArrayUploadimages = resultData.UploadTimesheetimage;
                PreviewByMonthlyLoadHoursWorkedAcctoDate(tsuserid, Timesheetmonarray5[0], Timesheetmonarray5[1], AID, PID);
                PreviewTimesheetsByWeekly(Timesheetmonarray5[1], resultDataArray);
                LoadTasklookupsByUser(tsuserid);
            },
            complete: function () {
                $('#loading-image').attr("style", "display: none;");
            }


        });
        LoadManagerData();

    }


    function ByMonthlyPreviewManagerSubmitTimesheet(id) {


        
        $("#table").closest(".clearfix.table-block").attr("style", "display: none;");
        $("#body_ClientDetails").attr("style", "display: table;");
        $("#Timesheet_dvTSMode").html("Bi-Monthly");



        $("#btnPrint").show();
        $("#btnpdf").show();
        $("#btnShare").show();
        $("#tabCon").empty();
        $("#MainTable").empty();
        $("#SubTable").empty();

        TimesheetID = id.getAttribute("data-TimesheetID");
        Tid = TimesheetID;
        MonthTimesheet = id.getAttribute("data-MonthYear");
        AppRejectstatus = id.getAttribute("data-TimesheetApprovalStatus");
        ByMonthlydates = id.getAttribute("data-ByMonthlyDates");
        empprojectname = id.getAttribute("data-ProjectName");
        empname = id.getAttribute("data-userName");
        empactualhrs = id.getAttribute("data-CompanyBillingHours");
        empworkedhrs = id.getAttribute("data-ResourceWorkingHours");
        cid = id.getAttribute("data-ClientprojectId");
        var Timesheetmonarray5 = new Array();
        Timesheetmonarray5 = ByMonthlydates.split("-");
        $("#divEditTimesheetData .btn-app").attr("style", "display: none;");
        $("#divPreviewTimesheet").attr("style", "display: none;");
        $("#divEditTimesheetData").attr("style", "display: block;");
        tsuserid = id.getAttribute("data-Usr_UserID");
        ApporRejprojectid = id.getAttribute("data-ProjectId");
        var myvariable = $('#UserGridData a').attr('id');
        var myManagerGridData = $('#ManagerGridData a').attr('id');
        var L1Managerid = id.getAttribute("data-UProj_L1ManagerId");
        var L2Managerid = id.getAttribute("data-UProj_L2ManagerId");
        var AID = $("#accid").val();
        var PID = $("#PrjId").val();
        TimesheetMonth = Timesheetmonarray5[1];
        ByMonthlystartdate = Timesheetmonarray5[0]; ByMonthlyenddate = Timesheetmonarray5[1];


        $('#loading-image').attr("style", "display: block;");
        $.ajax({
            url: "/Timesheet/ViewByWeeklySubmitedTimesheet",
            type: "GET",
            data: {
                TimesheetUserid: tsuserid, Timesheetstartdate: Timesheetmonarray5[0],
                TimesheetEnddate: Timesheetmonarray5[1],
                Accountid: AID, Projectid: ApporRejprojectid, clientProjectid: cid
            },
            contentType: 'application/json; charset=utf-8',
            dataType: 'JSON',
            async: false,
            success: function (resultData) {
                
                resultDataArray = resultData.timeSheetDetails;
                resultDataArrayUploadimages = resultData.UploadTimesheetimage;
                PreviewByMonthlyLoadHoursWorkedAcctoDate(tsuserid, Timesheetmonarray5[0], Timesheetmonarray5[1], AID, PID);
                PreviewTimesheetsByWeekly(Timesheetmonarray5[1], resultDataArray);
                LoadTasklookupsByUser(tsuserid);
            },
            complete: function () {
                $('#loading-image').attr("style", "display: none;");
            }


        });
        LoadManagerData();

    }

    function PreviewTimesheetsByWeekly(MonthTimesheet, resultData) {
        
        $("#tabCon").empty();
        $("#MainTable").empty();
        $("#SubTable").empty();
        var tbltask = ''; var objSelect = '';
        $('#Cmtsave').show();
        $("#ClientDetails2").show(true);
        var counter = -1;
        var counter15 = -1;

        $("#tabCon").append("<table name='maintbl' id='MainTable' width='100%' /*style='position:relative;left:10%;'*/>");
        $('#Timesheet_Duration').html(ByMonthlydates);

        
        $.each(resultData, function (k, v) {

            $("#txtDescription").html(v.Comments);

            if (v.ApprovedDate != '') {
                $("#ts_Approveid").html(v.ApprovedDate);
                $("#ts_approid").show();
            }
            else {
                $("#ts_Approveid").hide(v.ApprovedDate);
                $("#ts_approid").hide();
            }

            $("#ts_Submittedid").html(v.SubmittedDate);
            $("#ts_submited").show();
            $('#ts_ManagerNamesid1').html(v.ManagerName1);
            if (v.ManagerName2 != '0') {
                $('#ts_ManagerNamesid2').html(v.ManagerName2);
                $("b.ts_ManagerNamesid2").show();
                $("#ts_Manager2").show();
            }
            else {
                $("#ts_ManagerNamesid2").hide();
                $('#ts_ManagerNamesid2').html("");
                $("#ts_Manager2").hide();
            }


            //if (v.Submitted_Type == 0 && v.L1_ApproverStatus == 1 && v.L2_ApproverStatus == 0) {
            //    $("#TimesheetApprovalStatus").html("Approved By "  + v.ManagerName1 + " Pending at " + v.ManagerName2);
            //}
            //else if (v.Submitted_Type == 0 && v.L1_ApproverStatus == 0 && v.L2_ApproverStatus == 0) {
            //    $("#TimesheetApprovalStatus").html("Waiting for approval at both managers")
            //}
            //else if (v.Submitted_Type == 0) {
            //    $("#TimesheetApprovalStatus").html("Waithing for Approval");
            //}
            //else if (v.Submitted_Type == 1) {
            //    $("#TimesheetApprovalStatus").html("Approval by both managers");
            //}


            $("#StardateToEnddate").html("<span id='StartToEnd'><b>Timesheet of " + v.UserName + " for the Period of " + ByMonthlydates + "</b></span>");
            
            if (v.Submitted_Type == 1 && v.L1_ApproverStatus == 1 && v.L2_ApproverStatus == 1) {
                $("#UserStatus").html("Approved by both Managers").css("color", "Green");
            }

            else if (v.Submitted_Type == 1 && v.L1_ApproverStatus == 0 && v.L2_ApproverStatus == 0) {

                $("#UserStatus").html("Waiting for both Managers").css("color", "deepskyblue");

            }
            else if (v.Submitted_Type == 1 && v.L1_ApproverStatus == 1 && v.L2_ApproverStatus == 0) {
                $("#UserStatus").html("Approved By " + v.ManagerName1 + " Pending at " + v.ManagerName2).css("color", "rgb(204 102 11)");
            }
            else if (v.Submitted_Type == 0 && v.L1_ApproverStatus == 0 && v.L2_ApproverStatus == 2) {
                $("#UserStatus").html("Reject/Revoke By " + v.ManagerName2).css("color", "Red");
            }
            //else {

            //    $("#UserStatus").html("Reject/Revoke").css("color", "Red");
            //}

            if (k <= 6) {
                tbltask = 'uc1_ddlTask' + k;
                if (counter15 == -1) {

                    $("#MainTable").append("<td id='td1'>" +
                        "<table id='SubTable' width='100%' class='evAdminTable1'><tr style='background-color:black;color:white'><th width='160' text-align='center' class='evAdminTable'>Date </th> <th class='evAdminTable'>Task </th> <th width='50' class='evAdminTable'>Hours </th></tr>");

                }
                $("#SubTable").append("<tr><td class='colored'>" + v.MonthYearName + "</td><td class='colored' id='uc1_ddlTask" + k + "'>" + v.Taskname + "</td><div class='flex'><td class='colored' name='uc1txtHours'  id='uc1_txtHours" + k + "'><font>" + v.NoofHoursWorked + "</font><span id='HoursColours" + k + "' title=" + v.colour + " style='display: none;font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td></td>");
                //   $("#SubTable").append("<tr><td>" + v.MonthYearName + "</td><td><select id='uc1_ddlTask" + k + "' class='form-control lookup' selected  ></select></td><td><div class='flex'><input class='form-control uc1txtHours' name='hrs' type='number' title='Enter hours' min='0' max='24' maxlength='2' id='uc1_txtHours" + k + "' readonly value=" + v.NoofHoursWorked + "  style='width: 56px;'><span id='HoursColours" + k + "' style='font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td><td >&nbsp</td></td>");


                counter15 = counter15 + 1;

            }
            else {
                tbltask = 'uc1_ddlTask' + k;
                if (counter == -1) {
                    $("#SubTable").append("</table>")
                    $("#SubTable").append("</td>")
                    $("#MainTable").append("<td id='td2'><table id='SubTable2' /*style='position:relative;top:19px;'*/ width='100%' class='evAdminTable1'><tr style='background-color:black;color:white'><th width='160' text-align='center' class='evAdminTable'>Date </th> <th class='evAdminTable'>Task </th> <th width='50'class='evAdminTable'>Hours</th></tr>");
                }
                $("#SubTable2").append("<tr><td class='colored'>" + v.MonthYearName + "</td><td class='colored' id='uc1_ddlTask" + k + "'>" + v.Taskname + "</td><div class='flex'><td class='colored' name='uc1txtHours'  id='uc1_txtHours" + k + "'><font>" + v.NoofHoursWorked + "</font><span id='HoursColours" + k + "' title=" + v.colour + " style='display: none;font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td></td>");
                // $("#SubTable2").append("<tr><td>" + v.MonthYearName + "</td><td><select id='uc1_ddlTask" + k + "' class='form-control lookup' selected  ></select></td><td><div class='flex'><input class='form-control uc1txtHours' name='hrs' type='number' title='Enter hours' min='0' max='24' maxlength='2' id='uc1_txtHours" + k + "' readonly value=" + v.NoofHoursWorked + "  style='width: 56px;'><span id='HoursColours" + k + "' style='font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td><td >&nbsp</td></td>");
                counter = counter + 1;

            }

        });

        PreviewByMonthlyHoursDataColours();
        CalculatePreview();
        "</table>" + + "<hr />"
        $("#MainTable").append("</tr></table>") + "<hr />";
        $('table[id="SubTable"] tr > td:last-child').css("display", "table-cell");
        $('table[id="SubTable2"] tr > td:last-child').css("display", "table-cell");

        if (resultDataArrayUploadimages.length == 0) {
            $("#images,#previewFlImage,#imagestwo,#previewFlImage1").hide();
        }
        else if (resultDataArrayUploadimages.length == 1) {
            var url;
            url = "/TimeSheetimages/" + resultDataArrayUploadimages[0].Uploadedimages;
            if (url !== null && url !== "") {
                $("#images").show();
                $('#previewFlImage').prop('src', url);
                $("#imagestwo,#previewFlImage1").hide();
            } else {
                $("#images,#previewFlImage").hide();
            }

        }
        else {

            $.each(resultDataArrayUploadimages, function (k, v) {
                
                var url;
                if (k == 0) {
                    url = "/TimeSheetimages/" + v.Uploadedimages;
                    if (url !== null && url !== "") {
                        $("#images").show();
                        $('#previewFlImage').prop('src', url);
                    } else {
                        $("#images,#previewFlImage").hide();
                    }
                }
                else {
                    url = "/TimeSheetimages/" + v.Uploadedimages;
                    if (url !== null && url !== "") {
                        $("#imagestwo").show();
                        $('#previewFlImage1').prop('src', url);
                    } else {
                        $("#imagestwo,#previewFlImage1").hide();
                    }
                }

            });
        }
        //if (resultDataArrayUploadimages[0] == null) {
        //    $('#imgLogo').show();
        //    $("#images").show();
        //    //$('#imgLogo').prop('src', url);
        //    $('#previewFlImage').prop('src', "~/Content/images/user.png");
        //} else {
        //    var url = "/TimeSheetimages/" + resultDataArrayUploadimages[0].Uploadedimages;

        //    if (url !== null && url !== "") {
        //        $('#imgLogo').show();
        //        $("#images").show();
        //        //$('#imgLogo').prop('src', url);
        //        $('#previewFlImage').prop('src', url);

        //    }
        //}

        //if (resultDataArrayUploadimages[1] == null) {
        //    $('#imgLogo').show();
        //    $("#images1").show();
        //    //$('#imgLogo').prop('src', url);
        //    $('#previewFlImage1').prop('src', "~/Content/images/user.png");
        //} else {
        //    var url1 = "/TimeSheetimages/" + resultDataArrayUploadimages[1].Uploadedimages;

        //    if (url1 !== null && url1 !== "") {
        //        $('#imgLogo').show();
        //        $("#images1").show();
        //        //$('#imgLogo').prop('src', url);
        //        $('#previewFlImage1').prop('src', url1);

        //    }
        //}


    }

    //var loadFile = function (event) {
    //    var output = document.getElementById('imgLogo');

    //    output.src = URL.createObjectURL(event.target.files[0]);
    //    $('#imgLogo').show();
    //};


    function calculateSum() {

        var sum = 0;
        $(".uc1txtHours").each(function () {
            //add only if the value is number
            if (!isNaN(this.value) && this.value.length != 0) {
                sum += parseFloat(this.value);
            }
        });
        //.toFixed() method will roundoff the final sum to 2 decimal places
        $("#TotalHoursCount").html(sum.toFixed(2));
    }

    function LoadPreviewTasklookups() {

        $.ajax({
            type: "GET",
            url: "/Admin/getLookUp",
            datatype: "Json",
            async: false,
            //data: { id: id },
            success: function (data) {

                $(data).each(function () {

                    $(".lookup").append($("<option></option>").val(this.tsk_TaskID).html(this.tsk_TaskName));

                });


            }
        });
    }


    function LoadTasklookupsByUser(Userid) {

        $.ajax({
            type: "Post",
            url: "/Admin/GetLookUpByEmpId",
            datatype: "Json",
            async: false,
            data: { "Userid": Userid },
            success: function (data) {
                $(data).each(function () {
                    $(".lookup").append($("<option></option>").val(this.tsk_TaskID).html(this.tsk_TaskName));
                });
            }
        });
    }



    function ByWeeklyPreviewSubmitTimesheet(id) {
        console.log(id);
        
        $("#table").closest(".clearfix.table-block").attr("style", "display: none;");
        $("#body_ClientDetails").attr("style", "display: table;");
        $("#Timesheet_dvTSMode").html("Bi-Weekly");
        $("#btnPrint").show();
        $("#btnpdf").show();
        $("#btnShare").show();
        $("#tabCon").empty();
        $("#MainTable").empty();
        $("#SubTable").empty();
        var timesheetmode = id.getAttribute("data-TimesheetType");
        // $("#Timesheet_dvTSMode").html(timesheetmode);
        tsuserid = id.getAttribute("data-Usr_UserID");
        TimesheetID = id.getAttribute("data-TimesheetID");
        TSID = TimesheetID;
        MonthTimesheet = id.getAttribute("data-MonthYear");
        ByMonthlydates = id.getAttribute("data-ByMonthlyDates");
        AppRejectstatus = id.getAttribute("data-TimesheetApprovalStatus");
        Projectid = id.getAttribute("data-ProjectId");


        var AID = $("#accid").val();
        var PID = $("#PrjId").val();
        cid = id.getAttribute("data-ClientprojectId");
        var Timesheetmonarray4 = new Array();
        Timesheetmonarray4 = ByMonthlydates.split("-");
        TimesheetMonth = Timesheetmonarray4[1];
        ByMonthlystartdate = Timesheetmonarray4[0]; ByMonthlyenddate = Timesheetmonarray4[1];
        $("#divEditTimesheetData .btn-app").attr("style", "display: none;");
        $("#divPreviewTimesheet").attr("style", "display: none;");
        $("#divEditTimesheetData").attr("style", "display: block;");
        $('#loading-image').attr("style", "display: block;");
        $.ajax({
            url: "/Timesheet/ViewByWeeklySubmitedTimesheet",
            type: "GET",
            data: {
                TimesheetUserid: tsuserid, Timesheetstartdate: Timesheetmonarray4[0], TimesheetEnddate: Timesheetmonarray4[1],
                Accountid: AID,
                Projectid: Projectid, clientProjectid: cid

            },
            contentType: 'application/json; charset=utf-8',
            dataType: 'JSON',
            async: false,
            // cache: false,

            success: function (resultData) {
                resultDataArray = resultData.timeSheetDetails;
                resultDataArrayUploadimages = resultData.UploadTimesheetimage;
                PreviewByMonthlyLoadHoursWorkedAcctoDate(tsuserid, Timesheetmonarray4[0], Timesheetmonarray4[1], AID, PID);
                PreviewTimesheetsWeekly(Timesheetmonarray4[1], resultDataArray);
                LoadPreviewTasklookups();
            },
            complete: function () {
                $('#loading-image').attr("style", "display: none;");
            }

        });
        LoadData();
    }
    //function daysInMonth(month, year) {
    //    return new Date(year, month, 0).getDate();
    //}


    function openNav() {
        document.getElementById("mySidenav").style.width = "250px";
    }

    function closeNav() {
        document.getElementById("mySidenav").style.width = "0";
    }

    /////////////////////////////////////////////////////EditsubmitData////////////////////////////////////////////////////////



    function ManagerApprOrRej(id) {

        TimesheetID = id.getAttribute("data-TimesheetID");
        MonthTimesheet = id.getAttribute("data-MonthYear");
        tsuserid = id.getAttribute("data-Usr_UserID");
        ApporRejprojectid = id.getAttribute("data-ProjectId");

        empprojectname = id.getAttribute("data-ProjectName");
        empname = id.getAttribute("data-userName");
        empactualhrs = id.getAttribute("data-CompanyBillingHours");
        empworkedhrs = id.getAttribute("data-ResourceWorkingHours");
        TimesheetPeriod = id.getAttribute("data-TotalMonthName");
        var ApproveRejectstatus = id.getAttribute("data-Status");
        id = ApproveRejectstatus;
        TimesheetPeriodname = TimesheetPeriod.replace('-', ' to ');

        if (id == 3) {
            $("#btnAdd").show();
            $("#btnRej").hide();
            $('#PopupAppRejId').html("Approve Timesheet");
            $("#ProjectNameid").html("Do you want to approve <b> " + empname + "'s </b>timesheets within <b>" + empworkedhrs + "</b> hours for duration <b>" + TimesheetPeriodname + "</b> ");
        }
        if (id == 4) {
            $("#btnRej").show();
            $("#btnAdd").hide();
            $('#PopupAppRejId').html("Reject Timesheet");
            $("#ProjectNameid").html("Do you want to reject <b> " + empname + "'s </b>timesheets within <b>" + empworkedhrs + "</b> hours for duration <b>" + TimesheetPeriodname + "</b> ");
        }
        $('#ContainerGridDetail').show();


    }

    function ManagerApprOrRejFromWeb(id) {



        TimesheetPeriod = $("#Timesheet_Duration").html();


        if (id == '3' || id == '4') {

            id = id;
            if (id == 3) {
                $("#btnAdd").show();
                $("#btnRej").hide();
                $('#PopupAppRejId').html("Approve Timesheet");
                // $("#ProjectNameid").html("Do you want to approve <b> " + empname + "'s </b>  <b>" + MonthTimesheet + "</b> timesheets within <b>" + empworkedhrs + "</b> hours for <b>" + empprojectname + "</b>");
                $("#ProjectNameid").html("Do you want to approve <b> " + empname + "'s </b>timesheets within <b>" + empworkedhrs + "</b> hours for duration <b>" + TimesheetPeriod.replace('-', ' to ') + "</b> ");


            }
            if (id == 4) {
                $("#btnRej").show();
                $("#btnAdd").hide();
                $('#PopupAppRejId').html("Reject Timesheet");
                $("#ProjectNameid").html("Do you want to reject <b> " + empname + "'s </b>timesheets within <b>" + empworkedhrs + "</b> hours for duration <b>" + TimesheetPeriod.replace('-', ' to ') + "</b> ");
            }
            $('#ContainerGridDetail').show();
        }

    }


    function ApprovalRejectTimesheet(id) {
        

        if (id == '3' || id == '4') {

            id = id;
            Commentss = $.trim($("#txtDescription").val());
            MonthTimesheet = TimesheetMonth;

        }
        else {
            TimesheetID = id.getAttribute("data-TimesheetID");
            MonthTimesheet = id.getAttribute("data-MonthYear");
            tsuserid = id.getAttribute("data-Usr_UserID");
            Commentss = $.trim($("#txtDescription").val());
            var ApproveRejectstatus = id.getAttribute("data-Status");
            id = ApproveRejectstatus;

        }

        var projectid = ApporRejprojectid;
        var actualhrs = empactualhrs;

        var timesheets =

        {
            TimesheetID: TimesheetID,
            SubmittedType: id,
            TimeSheetMonth: MonthTimesheet,
            Comments: Commentss,
            UserID: tsuserid,
            ProjectID: projectid,

        }
        var sheetObj = {
            timesheets: timesheets,
        };




        $('#loading-image').attr("style", "display: block;");
        $.ajax({
            type: "POST",
            url: "/Timesheet/TimeSheetManagerActionWeb",
            data: JSON.stringify(sheetObj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                //   sendmailsbyapp(sheetObj);
                alert(data);
                window.location.reload();
            },
            complete: function () {
                $('#loading-image').attr("style", "display: none;");
            }
        });

    }

    function sendmailsbyapp(sheetObj) {
        $.ajax({
            type: "POST",
            url: "/Timesheet/SendMailsForApprovals",
            data: JSON.stringify(sheetObj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                //alert(data);
            }
        });
    }

    function LoadPreviewTaskData() {

        if (resultDataArray && resultDataArray.length > 0) {
            $.each(resultDataArray, function (index, value) {

                $('#uc1_ddlTask' + index).val(value.Taskid).attr("selected", "selected");
                $('#Timesheet_Duration').html(value.TotalMonthName);
                $('#ts_ClientNameid').html(value.ProjectName);
                $('#ts_ProjectNameid').html(value.ProjectClientName);
            });
        }
    }

    function LoadData() {

        if (resultDataArray && resultDataArray.length > 0) {
            $.each(resultDataArray, function (index, value) {

                //$('#uc1_ddlTask' + index).val(value.Taskid).attr("selected", "selected");//
                //$('#uc1_ddlTask' + index).val(value.Taskid).attr("disabled", "true");//
                $('#uc1_ddlTask' + index).val(value.Taskid).attr("selected", "true");
                $('#uc1_txtHours' + index).val(value.NoofHoursWorked).attr("selected", "true");
                $('#txtDescription').val(value.Comments).attr("disabled", "true");
                //$('#Timesheet_ProjectName').html(value.ProjectName);
                $('#Timesheet_Duration').html(value.TotalMonthName);
                $('#Timesheet_EmployeeName').html(value.UserName);
                $('#ts_ClientNameid').html(value.ProjectName);
                $('#ts_ProjectNameid').html(value.ProjectClientName);
                $('#btnSave').hide();
                $('#btnSend').hide();

            });
        }
    }
    function LoadManagerData() {

        if (resultDataArray && resultDataArray.length > 0) {
            $.each(resultDataArray, function (index, value) {

                $('#uc1_ddlTask' + index).val(value.Taskid).attr("selected", "selected");
                $('#uc1_ddlTask' + index).val(value.Taskid).attr("disabled", "true");
                // $('#txtDescription').val(value.Comments).attr("disabled", "true");
                $('#btnSave').hide();
                $('#btnSend').hide();
                //   $('#Timesheet_ProjectName').html(value.ProjectName);
                $('#ts_ClientNameid').html(value.ProjectName);
                $('#ts_ProjectNameid').html(value.ProjectClientName);
                $('#Timesheet_Duration').html(value.TotalMonthName);
                $('#Timesheet_EmployeeName').html(value.UserName);

            });
        }
    }

    function LoadClientDetails() {
        $.ajax({
            type: "GET",
            url: "/Timesheet/Usertimesheet",

            datatype: "Json",

            success: function (result) {


            }
        });
    }

    function AccSpecificTasksLoad() {

        $.ajax({
            type: "GET",
            url: "/ClientComponent/Getaccountspecifictasks",
            //contentType: "application/json; charset=utf-8",
            //dataType: "json",
            async: false,
            //data: { id: id },
            success: function (data) {

                //$(data).each(function () {

                //    $(".lookup").append($("<option></option>").val(this.Acc_SpecificTaskId).html(this.Acc_SpecificTaskName));

                //});


            }
        });
    }

    function LoadColoursonLeavesandHolidays(MonthTimesheet, tsuserid) {
        $.ajax({
            url: "/Timesheet/HoursWorkedTimesheet",
            type: "GET",
            data: { TimesheetMonth: MonthTimesheet, TimesheetUserid: tsuserid },
            contentType: 'application/json; charset=utf-8',
            dataType: 'JSON',
            async: false,
            // cache: false,

            success: function (resultData) {
                resultHoursWorkedColour = resultData

            },

        });
    }

    function HoursDataColoursPreview() {
        $.each(resultHoursWorkedColour, function (index, value) {
            //if (value.colour == 'black') {
            //    value.colour = 'white';
            //}
            $('#HoursColours' + index).attr('style', 'font-size:25px;line-height:25px;color:' + value.colour);
            $('#HoursColours' + index).attr('title', value.colour);
        });

    }

    function print_page() {
        window.print();
    }

    $("body").on("click", "#btnpdf", function () {




        html2canvas($('#divEditTimesheetData')[0], {
            onrendered: function (canvas) {
                var data = canvas.toDataURL();
                var docDefinition = {
                    content: [{
                        image: data,
                        width: 500
                    }]
                };
                pdfMake.createPdf(docDefinition).download("Timesheet.pdf");
            }
        });
    });


    $("#btnclose").click(function () {
        window.location.reload();
    });

    function CalculatePreview() {

        var sum = 0;
        $("td.colored[name='uc1txtHours'] > font").each(function () {

            //sum += Number($(this).val()) || 0;
            sum += parseInt($(this).text());


        });

        $("#TotalHoursCount").html(sum);
    }


    function ShareTimesheet() {
        
        var tomail = $("#emailto").val();
        var Subj = $("#subject").val();
        var sectomail = $("#emailto2").val();
        var formData = new FormData();

        formData.append("mail", tomail);
        formData.append("mail", sectomail);
        formData.append("Subject", Subj);
        formData.append("TimeSheetId", Tid);

        $.ajax({
            type: "POST",
            url: "/Timesheet/ShareTimesheets",

            data: formData,
            contentType: false,
            processData: false,
            success: function (data, status) {
                window.location.reload();
                alert("TimeSheet Shared Sucessfully");
            },
            error: function (xhr, data, status) {

            }

        });
    }



    function PreviewTimesheetsWeekly(MonthTimesheet, resultData) {
        
        $("#tabCon").empty();
        $("#MainTable").empty();
        $("#SubTable").empty();
        var tbltask = ''; var objSelect = '';
        $('#Cmtsave').show();
        $("#ClientDetails2").show(true);
        $("#Timesheet_dvTSMode").html("Weekly");
        var counter = -1;
        var counter15 = -1;

        $("#tabCon").append("<table name='maintbl' id='MainTable' width='100%' /*style='position:relative;left:10%;'*/>");
        $('#Timesheet_Duration').html(ByMonthlydates);

        $.each(resultData, function (k, v) {

            $("#txtDescription").html(v.Comments);

            if (v.ApprovedDate != '') {
                $("#ts_Approveid").html(v.ApprovedDate);
                $("#ts_approid").show();
            }
            else {
                $("#ts_Approveid").hide(v.ApprovedDate);
                $("#ts_approid").hide();
            }

            $("#ts_Submittedid").html(v.SubmittedDate);
            $("#ts_submited").show();
            $('#ts_ManagerNamesid1').html(v.ManagerName1);
            if (v.ManagerName2 != '0') {
                $('#ts_ManagerNamesid2').html(v.ManagerName2);
                $("b.ts_ManagerNamesid2").show();
                $("#ts_Manager2").show();
            }
            else {
                $("#ts_ManagerNamesid2").hide();
                $('#ts_ManagerNamesid2').html("");
                $("#ts_Manager2").hide();
            }

            $("#StardateToEnddate").html("<span id='StartToEnd'><b>Timesheet of " + v.UserName + " for the Period of " + ByMonthlydates + "</b></span>");
            if (k <= 6) {
                tbltask = 'uc1_ddlTask' + k;
                if (counter15 == -1) {

                    $("#MainTable").append("<td id='td1'>" +
                        "<table id='SubTable' width='100%' class='evAdminTable1'><tr style='background-color:black;color:white'><th width='160' text-align='center' class='evAdminTable'>Date </th> <th class='evAdminTable'>Task </th> <th width='50' class='evAdminTable'>Hours </th></tr>");

                }
                $("#SubTable").append("<tr><td class='colored'>" + v.MonthYearName + "</td><td class='colored' id='uc1_ddlTask" + k + "'>" + v.Taskname + "</td><div class='flex'><td class='colored' name='uc1txtHours'  id='uc1_txtHours" + k + "'><font>" + v.NoofHoursWorked + "</font><span id='HoursColours" + k + "' title=" + v.colour + " style='display: none;font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td></td>");
                //   $("#SubTable").append("<tr><td>" + v.MonthYearName + "</td><td><select id='uc1_ddlTask" + k + "' class='form-control lookup' selected  ></select></td><td><div class='flex'><input class='form-control uc1txtHours' name='hrs' type='number' title='Enter hours' min='0' max='24' maxlength='2' id='uc1_txtHours" + k + "' readonly value=" + v.NoofHoursWorked + "  style='width: 56px;'><span id='HoursColours" + k + "' style='font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td><td >&nbsp</td></td>");


                counter15 = counter15 + 1;

            }
            else {
                tbltask = 'uc1_ddlTask' + k;
                if (counter == -1) {
                    $("#SubTable").append("</table>")
                    $("#SubTable").append("</td>")
                    $("#MainTable").append("<td id='td2'><table id='SubTable2' /*style='position:relative;top:19px;'*/ width='100%' class='evAdminTable1'><tr style='background-color:black;color:white'><th width='160' text-align='center' class='evAdminTable'>Date </th> <th class='evAdminTable'>Task </th> <th width='50'class='evAdminTable'>Hours</th></tr>");
                }
                $("#SubTable2").append("<tr><td class='colored'>" + v.MonthYearName + "</td><td class='colored' id='uc1_ddlTask" + k + "'>" + v.Taskname + "</td><div class='flex'><td class='colored' name='uc1txtHours'  id='uc1_txtHours" + k + "'><font>" + v.NoofHoursWorked + "</font><span id='HoursColours" + k + "' title=" + v.colour + " style='display: none;font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td></td>");
                // $("#SubTable2").append("<tr><td>" + v.MonthYearName + "</td><td><select id='uc1_ddlTask" + k + "' class='form-control lookup' selected  ></select></td><td><div class='flex'><input class='form-control uc1txtHours' name='hrs' type='number' title='Enter hours' min='0' max='24' maxlength='2' id='uc1_txtHours" + k + "' readonly value=" + v.NoofHoursWorked + "  style='width: 56px;'><span id='HoursColours" + k + "' style='font-size: 25px;line-height: 25px;color:" + v.colour + "'>* </span></div></td><td >&nbsp</td></td>");
                counter = counter + 1;

            }

        });

        PreviewByMonthlyHoursDataColours();
        CalculatePreview();

        "</table>" + + "<hr />"
        $("#MainTable").append("</tr></table>") + "<hr />";
        $('table[id="SubTable"] tr > td:last-child').css("display", "table-cell");
        $('table[id="SubTable2"] tr > td:last-child').css("display", "table-cell");
        if (resultDataArrayUploadimages.length == 0) {
            $("#images,#previewFlImage,#imagestwo,#previewFlImage1").hide();
        }
        else if (resultDataArrayUploadimages.length == 1) {
            var url;
            url = "/TimeSheetimages/" + resultDataArrayUploadimages[0].Uploadedimages;
            if (url !== null && url !== "") {
                $("#images").show();
                $('#previewFlImage').prop('src', url);
                $("#imagestwo,#previewFlImage1").hide();
            } else {
                $("#images,#previewFlImage").hide();
            }

        }
        else {

            $.each(resultDataArrayUploadimages, function (k, v) {
                
                var url;
                if (k == 0) {
                    url = "/TimeSheetimages/" + v.Uploadedimages;
                    if (url !== null && url !== "") {
                        $("#images").show();
                        $('#previewFlImage').prop('src', url);
                    } else {
                        $("#images,#previewFlImage").hide();
                    }
                }
                else {
                    url = "/TimeSheetimages/" + v.Uploadedimages;
                    if (url !== null && url !== "") {
                        $("#imagestwo").show();
                        $('#previewFlImage1').prop('src', url);
                    } else {
                        $("#imagestwo,#previewFlImage1").hide();
                    }
                }

            });
        }
        //$.each(resultDataArrayUploadimages, function (k, v) {
        //    var url = "/TimeSheetimages/" + v.Uploadedimages;

        //    if (url !== null && url !== "") {
        //        $('#imgLogo').show();
        //        $("#images").show();
        //        $('#previewFlImage').prop('src', url);
        //        //   $('#imgLogo').prop('src', url);
        //        //$("#images").append("<img id='imgModal_" + v.Attachmentid + "' src='" + url + "' class='img-responsive' data-toggle='modal' data-target='#imgModal' style='display:inline-block' alt='Logo' width='150' height='55' />");
        //        //$("#images > img#imgModal_" + v.Attachmentid + ".img-responsive[data-toggle='modal']").on('click', function () {
        //        //    var image = $(this).attr('src');
        //        //    
        //        //    console.log(image);
        //        //    $('#imgModal').on('show.bs.modal', function () {
        //        //        $("img#showimage.showimage").attr("src", image);
        //        //    });
        //        //});
        //    }


        //});


    }


    function PreviewByMonthlyHoursDataColours() {
        $.each(resultHoursWorkedColourArray, function (index, value) {
            //if (value.colour == 'black') {
            //    value.colour = 'white';
            //}
            $('#HoursColours' + index).attr('style', 'font-size:25px;line-height:25px;color:' + value.colour);
            $('#HoursColours' + index).attr('title', value.colour);
        });

    }
    function PreviewByMonthlyLoadHoursWorkedAcctoDate(tsuserid, Timesheetstartdate, Timesheetenddate, accountid, projectid) {
        $.ajax({
            url: "/Timesheet/LoadColourBymonthly",
            type: "GET",
            data: {
                Timesheetstartdate: Timesheetstartdate, TimesheetEnddate: Timesheetenddate,
                TimesheetUserid: tsuserid, accountid: accountid, projectid: projectid
            },
            contentType: 'application/json; charset=utf-8',
            dataType: 'JSON',
            async: false,
            // cache: false,

            success: function (resultData) {
                resultHoursWorkedColourArray = resultData

            },

        });
    }

</script>